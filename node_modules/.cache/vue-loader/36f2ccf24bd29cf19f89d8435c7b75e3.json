{"remainingRequest":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\roemer\\Documents\\2019\\stay-manager\\src\\tabs\\invoice-tab.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\src\\tabs\\invoice-tab.vue","mtime":1577008336894},{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576626834856},{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\babel-loader\\lib\\index.js","mtime":1576626834590},{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576626834856},{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\vue-loader\\lib\\index.js","mtime":1576626847671}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWUgZnJvbSAidnVlIjsKaW1wb3J0IGh0bWxpbnZvaWNlIGZyb20gIi4uL2h0bWxpbnZvaWNlLnZ1ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBodG1saW52b2ljZSB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNDb21wb25lbnRNb2RhbEFjdGl2ZTogZmFsc2UsCiAgICAgIGJvb2tpbmc6IHRoaXMuJHN0b3JlLnN0YXRlLmJvb2tpbmcsCiAgICAgIHRlbXBEZXBvc2l0OiB7CiAgICAgICAgaWQ6IG51bGwsCiAgICAgICAgc3RhdHVzOiBudWxsLAogICAgICAgIHR5cGU6IG51bGwsCiAgICAgICAgYW1vdW50OiBudWxsLAogICAgICAgIGRhdGVSZWNlaXZlZDogbnVsbAogICAgICB9LAogICAgICB0ZW1wQ29zdDogewogICAgICAgIGlkOiBudWxsLAogICAgICAgIHR5cGU6IG51bGwsCiAgICAgICAgbGFiZWw6IG51bGwsCiAgICAgICAgdW5pdHM6IG51bGwsCiAgICAgICAgdW5pdFByaWNlOiBudWxsLAogICAgICAgIHRvdGFsUHJpY2U6IG51bGwKICAgICAgfQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7fSwKICB3YXRjaDoge30sCgogIG1ldGhvZHM6IHsKICAgIGdldElkOiBmdW5jdGlvbihvYmplY3QpIHsKICAgICAgdmFyIGFyciA9IFtdOwogICAgICBmb3IgKHZhciBvYmogaW4gb2JqZWN0KSB7CiAgICAgICAgYXJyLnB1c2gocGFyc2VJbnQob2JqKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIE1hdGgubWF4KC0xLCAuLi5hcnIpICsgMTsKICAgIH0sCiAgICBvcGVuTW9kYWwoKSB7CiAgICAgIHRoaXMuJGJ1ZWZ5Lm1vZGFsLm9wZW4oewogICAgICAgIHBhcmVudDogdGhpcywKICAgICAgICBjb21wb25lbnQ6IGh0bWxJbnZvaWNlLAogICAgICAgIGhhc01vZGFsQ2FyZDogZmFsc2UKICAgICAgfSk7CiAgICB9LAogICAgYWRkRGVwb3NpdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciB0ZW1wRGVwb3NpdCA9IHRoaXMudGVtcERlcG9zaXQ7CiAgICAgIHZhciB0ZW1wRGVwb3NpdHMgPSB0aGlzLmJvb2tpbmcuZGVwb3NpdHM7CiAgICAgIHRlbXBEZXBvc2l0LmlkID0gdGhpcy5nZXRJZCh0ZW1wRGVwb3NpdHMpOwogICAgICB0ZW1wRGVwb3NpdHMucHVzaCh0ZW1wRGVwb3NpdCk7CgogICAgICBWdWUuc2V0KAogICAgICAgIHRoaXMuYm9va2luZywKICAgICAgICAiZGVwb3NpdHMiLAogICAgICAgIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGVtcERlcG9zaXRzKSkKICAgICAgKTsKICAgICAgdGhpcy50ZW1wRGVwb3NpdCA9IHsKICAgICAgICBpZDogbnVsbCwKICAgICAgICBzdGF0dXM6IG51bGwsCiAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICBhbW91bnQ6IG51bGwsCiAgICAgICAgZGF0ZVJlY2VpdmVkOiBudWxsCiAgICAgIH07CiAgICB9LAoKICAgIHByaW50SW52b2ljZSgpIHsKICAgICAgdmFyIHByaW50V2luZG93ID0gd2luZG93Lm9wZW4oIi4vaHRtbGludm9pY2UiKTsKICAgICAgcHJpbnRXaW5kb3cuZm9jdXMoKTsKICAgICAgcHJpbnRXaW5kb3cucHJpbnQoKTsKICAgIH0sCgogICAgYWRkQ29zdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciB0ZW1wQ29zdCA9IHRoaXMudGVtcENvc3Q7CiAgICAgIHZhciB0ZW1wQ29zdHMgPSB0aGlzLmJvb2tpbmcuY29zdHM7CiAgICAgIHRlbXBDb3N0LmlkID0gdGhpcy5nZXRJZCh0ZW1wQ29zdHMpOwogICAgICB0ZW1wQ29zdHMucHVzaCh0ZW1wQ29zdCk7CgogICAgICBWdWUuc2V0KHRoaXMuYm9va2luZywgImNvc3RzIiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0ZW1wQ29zdHMpKSk7CiAgICAgIHRoaXMudGVtcENvc3QgPSB7CiAgICAgICAgaWQ6IG51bGwsCiAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICBsYWJlbDogbnVsbCwKICAgICAgICB1bml0czogbnVsbCwKICAgICAgICB1bml0UHJpY2U6IG51bGwsCiAgICAgICAgdG90YWxQcmljZTogbnVsbAogICAgICB9OwogICAgfSwKICAgIGdldERlcG9zaXRJY29uOiBmdW5jdGlvbihkZXBvc2l0VHlwZSkgewogICAgICBpZiAoZGVwb3NpdFR5cGUgPT09ICJjaGVxdWUiKSB7CiAgICAgICAgcmV0dXJuICJtb25leS1jaGVjay1hbHQiOwogICAgICB9IGVsc2UgaWYgKGRlcG9zaXRUeXBlID09PSAiY2FzaCIpIHsKICAgICAgICByZXR1cm4gIm1vbmV5LWJpbGwtd2F2ZSI7CiAgICAgIH0gZWxzZSBpZiAoZGVwb3NpdFR5cGUgPT09ICJ0cmFuc2ZlciIpIHsKICAgICAgICByZXR1cm4gImV4Y2hhbmdlLWFsdCI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICJtb25leS1jaGVjay1hbHQiOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["invoice-tab.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwLA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"invoice-tab.vue","sourceRoot":"src/tabs","sourcesContent":["<template>\n  <!-- FORM -->\n  <section class=\"section\" style=\"height:100%\">\n    <div class=\"container\">\n      <div class=\"box\">\n        <!-- FORM TITLE -->\n        <h3 class=\"title is-3\">Facture</h3>\n        <!-- DEPOSITS -->\n        <label class=\"label\">Caution</label>\n\n        <!-- DEPOSIT LIST -->\n        <div\n          class=\"container\"\n          style=\"margin-bottom:1rem;\"\n          v-for=\"deposit in booking.deposits\"\n          :key=\"deposit.id\"\n        >\n          <article class=\"message is-light\">\n            <div class=\"message-header\">\n              <p>\n                <b-icon\n                  style=\"margin-right:0.5ch;display: inline-table;\"\n                  pack=\"fas\"\n                  :icon=\"getDepositIcon(deposit.type)\"\n                  size=\"is-medium\"\n                  type=\"is-grey\"\n                ></b-icon>\n                <span class=\"has-text-grey\">{{ deposit.type }} -</span>\n                {{ deposit.amount }} euros\n              </p>\n              <span\n                :class=\"\n                  'tag is-medium ' +\n                    (deposit.status === 'pending' ? 'is-warning' : 'is-success')\n                \"\n              >\n                {{\n                  deposit.dateReceived === null\n                    ? \"\"\n                    : deposit.dateReceived.substring(0, 10) + \", \"\n                }}\n                {{ deposit.status }}\n              </span>\n              <button\n                @click=\"$delete(booking.deposits, deposit.id)\"\n                class=\"delete\"\n              ></button>\n            </div>\n          </article>\n        </div>\n\n        <!-- ADD DEPOSIT -->\n        <div class=\"container\">\n          <b-field grouped group-multiline>\n            <b-field label=\"Statut\" label-position=\"on-border\">\n              <b-select\n                v-model=\"tempDeposit.status\"\n                placeholder=\"Select a status\"\n              >\n                <option value=\"pending\">En attente</option>\n                <option value=\"received\">Recu</option>\n                <option value=\"returned\">Rendu</option>\n              </b-select>\n            </b-field>\n            <b-field label=\"Montant\" label-position=\"on-border\">\n              <b-input v-model=\"tempDeposit.amount\"></b-input>\n            </b-field>\n            <b-field label=\"Date reception\" label-position=\"on-border\">\n              <b-datepicker\n                icon-pack=\"fas\"\n                v-model=\"tempDeposit.dateReceived\"\n                placeholder=\"Date de reception\"\n              ></b-datepicker>\n            </b-field>\n            <b-field label=\"Type\" label-position=\"on-border\">\n              <b-select v-model=\"tempDeposit.type\" placeholder=\"Select a type\">\n                <option value=\"cheque\">Cheque</option>\n                <option value=\"transfer\">Virement</option>\n                <option value=\"cash\">Liquide</option>\n              </b-select>\n            </b-field>\n            <b-button type=\"is-primary\" @click=\"addDeposit()\">Ajouter</b-button>\n          </b-field>\n\n          <hr />\n\n          <!-- EXTRA TRANSACTIONS -->\n          <label class=\"label\">Transactions supplémentaires</label>\n\n          <!-- TRANSACTION LIST -->\n          <div\n            class=\"container\"\n            style=\"margin-bottom:1rem;\"\n            v-for=\"cost in booking.costs\"\n            :key=\"cost.id\"\n          >\n            <article class=\"message is-light\">\n              <div class=\"message-header\">\n                <p>\n                  <b-icon\n                    style=\"margin-right:0.5ch;display: inline-table;\"\n                    pack=\"fas\"\n                    :icon=\"cost.type === 'payment' ? 'arrow-up' : 'arrow-down'\"\n                    size=\"is-medium\"\n                    type=\"is-grey\"\n                  ></b-icon>\n                  {{ cost.label }}\n                  <span class=\"has-text-grey\"\n                    >{{ cost.units }} x {{ cost.unitPrice }} €</span\n                  >\n                </p>\n                <span\n                  :class=\"\n                    'tag ' +\n                      (cost.type === 'payment' ? 'is-success' : 'is-danger')\n                  \"\n                >\n                  {{ cost.type === \"payment\" ? \"+\" : \"-\" }}\n                  {{ cost.totalPrice }} €\n                </span>\n\n                <button\n                  @click=\"$delete(booking.costs, cost.id)\"\n                  class=\"delete\"\n                ></button>\n              </div>\n            </article>\n          </div>\n\n          <!-- ADD TRANSACTION -->\n          <div class=\"container\">\n            <b-field grouped group-multiline>\n              <b-field label=\"Type\" label-position=\"on-border\">\n                <b-select v-model=\"tempCost.type\" placeholder=\"Type\">\n                  <option value=\"payment\">Paiement</option>\n                  <option value=\"cost\">Coût</option>\n                </b-select>\n              </b-field>\n              <b-field label=\"Label\" label-position=\"on-border\">\n                <b-input v-model=\"tempCost.label\"></b-input>\n              </b-field>\n              <b-field label=\"Unités\" label-position=\"on-border\">\n                <b-input v-model=\"tempCost.units\"></b-input>\n              </b-field>\n              <b-field label=\"Prix unitaire\" label-position=\"on-border\">\n                <b-input v-model=\"tempCost.unitPrice\"></b-input>\n              </b-field>\n              <b-field label=\"Total\" label-position=\"on-border\">\n                <b-numberinput\n                  :controls=\"false\"\n                  step=\"0.01\"\n                  v-model=\"tempCost.totalPrice\"\n                ></b-numberinput>\n              </b-field>\n              <b-button type=\"is-primary\" @click=\"addCost()\">Ajouter</b-button>\n            </b-field>\n          </div>\n\n          <hr />\n\n          <!-- OPEN MODAL -->\n          <b-button type=\"is-primary\" @click=\"isComponentModalActive = true\"\n            >Open Modal</b-button\n          >\n\n          <b-button type=\"is-primary\" @click=\"printInvoice()\"\n            >Print Invoice</b-button\n          >\n\n          <b-modal\n            :active.sync=\"isComponentModalActive\"\n            trap-focus\n            width=\"90%\"\n            style=\"height:100%;\"\n          >\n            <htmlinvoice></htmlinvoice>\n          </b-modal>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport Vue from \"vue\";\nimport htmlinvoice from \"../htmlinvoice.vue\";\n\nexport default {\n  components: { htmlinvoice },\n\n  data() {\n    return {\n      isComponentModalActive: false,\n      booking: this.$store.state.booking,\n      tempDeposit: {\n        id: null,\n        status: null,\n        type: null,\n        amount: null,\n        dateReceived: null\n      },\n      tempCost: {\n        id: null,\n        type: null,\n        label: null,\n        units: null,\n        unitPrice: null,\n        totalPrice: null\n      }\n    };\n  },\n  computed: {},\n  watch: {},\n\n  methods: {\n    getId: function(object) {\n      var arr = [];\n      for (var obj in object) {\n        arr.push(parseInt(obj));\n      }\n      return Math.max(-1, ...arr) + 1;\n    },\n    openModal() {\n      this.$buefy.modal.open({\n        parent: this,\n        component: htmlInvoice,\n        hasModalCard: false\n      });\n    },\n    addDeposit: function() {\n      var tempDeposit = this.tempDeposit;\n      var tempDeposits = this.booking.deposits;\n      tempDeposit.id = this.getId(tempDeposits);\n      tempDeposits.push(tempDeposit);\n\n      Vue.set(\n        this.booking,\n        \"deposits\",\n        JSON.parse(JSON.stringify(tempDeposits))\n      );\n      this.tempDeposit = {\n        id: null,\n        status: null,\n        type: null,\n        amount: null,\n        dateReceived: null\n      };\n    },\n\n    printInvoice() {\n      var printWindow = window.open(\"./htmlinvoice\");\n      printWindow.focus();\n      printWindow.print();\n    },\n\n    addCost: function() {\n      var tempCost = this.tempCost;\n      var tempCosts = this.booking.costs;\n      tempCost.id = this.getId(tempCosts);\n      tempCosts.push(tempCost);\n\n      Vue.set(this.booking, \"costs\", JSON.parse(JSON.stringify(tempCosts)));\n      this.tempCost = {\n        id: null,\n        type: null,\n        label: null,\n        units: null,\n        unitPrice: null,\n        totalPrice: null\n      };\n    },\n    getDepositIcon: function(depositType) {\n      if (depositType === \"cheque\") {\n        return \"money-check-alt\";\n      } else if (depositType === \"cash\") {\n        return \"money-bill-wave\";\n      } else if (depositType === \"transfer\") {\n        return \"exchange-alt\";\n      } else {\n        return \"money-check-alt\";\n      }\n    }\n  }\n};\n</script>\n\n<style scoped></style>\n"]}]}