{"remainingRequest":"/home/roemer/Documents/2019/stay-manager/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/roemer/Documents/2019/stay-manager/src/components/form-stay.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/home/roemer/Documents/2019/stay-manager/src/components/form-stay.vue","mtime":1574443725660},{"path":"/home/roemer/Documents/2019/stay-manager/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/roemer/Documents/2019/stay-manager/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/roemer/Documents/2019/stay-manager/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/roemer/Documents/2019/stay-manager/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/roemer/Documents/2019/stay-manager/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/roemer/Documents/2019/stay-manager/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQGltcG9ydCAiQC9zY3NzL19teXN0eWxlcy5zY3NzIjsK"},{"version":3,"sources":["form-stay.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4JA","file":"form-stay.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"container\">\n    <!-- FORM SECTION TITLE -->\n    <h6 class=\"title is-6\">Nuitées</h6>\n    <!-- ARRIVAL -->\n    <b-field label=\"Check-in\" label-position=\"on-border\">\n      <b-datetimepicker\n        v-model=\"stay.arrivalDatetime\"\n        ref=\"arrivalDatetimePicker\"\n        placeholder=\"Check-in\"\n        :timepicker=\"{incrementMinutes:15}\"\n        :datetime-formatter=\"humanFormatDatetime\"\n        :mobile-native=\"false\"\n      >\n        <template slot=\"right\">\n          <button class=\"button is-success\" @click=\"$refs.arrivalDatetimePicker.toggle()\">\n            <b-icon icon=\"check\"></b-icon>\n            <span>Valider</span>\n          </button>\n        </template>\n      </b-datetimepicker>\n    </b-field>\n    <!-- DEPARTURE -->\n    <b-field label=\"Check-out\" label-position=\"on-border\">\n      <b-datetimepicker\n        v-model=\"stay.departureDatetime\"\n        ref=\"departureDatetimePicker\"\n        placeholder=\"Check-out\"\n        :timepicker=\"{incrementMinutes:15}\"\n        :datetime-formatter=\"humanFormatDatetime\"\n        :mobile-native=\"false\"\n      >\n        <template slot=\"right\">\n          <button class=\"button is-success\" @click=\"$refs.departureDatetimePicker.toggle()\">\n            <b-icon icon=\"check\"></b-icon>\n            <span>Valider</span>\n          </button>\n        </template>\n      </b-datetimepicker>\n    </b-field>\n\n    <!-- GUESTS -->\n    <b-field label=\"Invités payants\" label-position=\"on-border\" message=\"2 ans et plus\">\n      <b-numberinput v-model=\"stay.baseGuests\" min=\"10\" controlsPosition=\"compact\"></b-numberinput>\n    </b-field>\n\n    <!-- CHILDREN -->\n    <b-field label=\"Enfants\" label-position=\"on-border\">\n      <b-numberinput v-model=\"stay.children\" min=\"0\" controlsPosition=\"compact\"></b-numberinput>\n    </b-field>\n\n    <!-- PETS -->\n    <b-field label=\"Animaux de compagnie\" label-position=\"on-border\">\n      <b-numberinput v-model=\"stay.pets\" min=\"0\" controlsPosition=\"compact\"></b-numberinput>\n    </b-field>\n\n    <!-- GUEST INFO -->\n    <b-field label=\"Informations supplémentaires\">\n      <b-input v-model=\"stay.guestInfo\" type=\"textarea\"></b-input>\n    </b-field>\n\n    <!-- GUEST DETAILED CONTROLS -->\n    <b-collapse :open=\"false\" class=\"card\" aria-id=\"editNightContent\">\n      <div slot=\"trigger\" class=\"card-header\" role=\"button\" aria-controls=\"editNightContent\">\n        <p class=\"card-header-title\">{{ this.stay.stayNightArray.length }} nights</p>\n        <a class=\"card-header-icon\">\n          <b-icon type=\"is-dark\" icon=\"caret-down\"></b-icon>\n        </a>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"content\">\n          <div v-for=\"night in stay.stayNightArray\" :key=\"night.id\">\n            <b-field grouped>\n              <b-field\n                style=\"width:100%;\"\n                :label=\"editNightContentTextFormat(night.date)\"\n                type=\"has-text-grey\"\n              >\n                <b-numberinput v-model=\"night.guests\" min=\"10\" controlsPosition=\"compact\"></b-numberinput>\n              </b-field>\n            </b-field>\n          </div>\n        </div>\n      </div>\n    </b-collapse>\n  </div>\n</template>\n\n<script>\nimport moment from \"moment\";\n\nexport default {\n  data() {\n    return {\n      stay: this.$store.state.stay\n    };\n  },\n  computed: {\n    computedStay: function() {\n      return Object.assign({}, this.stay);\n    },\n    stayNightArray: function() {\n      var tempStayNightArray = [];\n      var tempArrivalDate = moment(this.stay.arrivalDatetime);\n      var tempDepartureDate = moment(this.stay.departureDatetime);\n\n      var i = 0;\n      while (tempArrivalDate < tempDepartureDate) {\n        var tempStayNightObject = {\n          id: i,\n          date: tempArrivalDate.unix(),\n          guests: this.stay.baseGuests\n        };\n        tempStayNightArray.push(tempStayNightObject);\n        tempArrivalDate = tempArrivalDate.add(1, \"days\");\n        i++;\n      }\n      return tempStayNightArray;\n    }\n  },\n  methods: {\n    humanFormatDatetime: function(date) {\n      return moment(date).format(\"ddd D MMM YYYY - HH:mm\");\n    },\n    editNightContentTextFormat: function(date) {\n      return moment.unix(date).format(\"dddd D\");\n    }\n  },\n  watch: {\n    computedStay: {\n      // Update departure date (not time) if the arrival date changes\n      deep: true,\n      handler: function(newStay, oldStay) {\n        var oldStayArrivalDatetime = moment(oldStay.arrivalDatetime);\n        var oldStayDepartureDatetime = moment(oldStay.departureDatetime);\n        var newStayArrivalDatetime = moment(newStay.arrivalDatetime);\n        var newStayDepartureDatetime = moment(newStay.departureDatetime);\n        if (\n          (oldStayArrivalDatetime.format(\"LL\") !==\n            newStayArrivalDatetime.format(\"LL\")) &\n          (oldStayDepartureDatetime.format(\"LL\") ==\n            newStayDepartureDatetime.format(\"LL\"))\n        ) {\n          this.stay.departureDatetime = newStayArrivalDatetime\n            .hour(oldStayDepartureDatetime.hour())\n            .minute(oldStayDepartureDatetime.minute())\n            .toDate();\n        }\n        this.stay.stayNightArray = this.stayNightArray;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=scss>\n@import \"@/scss/_mystyles.scss\";\n</style>\n"]}]}