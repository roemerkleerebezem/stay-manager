{"remainingRequest":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\roemer\\Documents\\2019\\stay-manager\\src\\components\\form-stay.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\src\\components\\form-stay.vue","mtime":1576953421883},{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576626834856},{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\babel-loader\\lib\\index.js","mtime":1576626834590},{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576626834856},{"path":"C:\\Users\\roemer\\Documents\\2019\\stay-manager\\node_modules\\vue-loader\\lib\\index.js","mtime":1576626847671}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHN0YXk6IHRoaXMuJHN0b3JlLnN0YXRlLnN0YXkKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgY29tcHV0ZWRTdGF5OiBmdW5jdGlvbiBjb21wdXRlZFN0YXkoKSB7CiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnN0YXkpOwogICAgfSwKICAgIHN0YXlOaWdodEFycmF5OiBmdW5jdGlvbiBzdGF5TmlnaHRBcnJheSgpIHsKICAgICAgdmFyIHRlbXBTdGF5TmlnaHRBcnJheSA9IFtdOwogICAgICB2YXIgdGVtcEFycml2YWxEYXRlID0gbW9tZW50KHRoaXMuc3RheS5hcnJpdmFsRGF0ZXRpbWUpOwogICAgICB2YXIgdGVtcERlcGFydHVyZURhdGUgPSBtb21lbnQodGhpcy5zdGF5LmRlcGFydHVyZURhdGV0aW1lKTsKICAgICAgdmFyIGkgPSAwOwoKICAgICAgd2hpbGUgKHRlbXBBcnJpdmFsRGF0ZSA8IHRlbXBEZXBhcnR1cmVEYXRlKSB7CiAgICAgICAgdmFyIHRlbXBTdGF5TmlnaHRPYmplY3QgPSB7CiAgICAgICAgICBpZDogaSwKICAgICAgICAgIGRhdGU6IHRlbXBBcnJpdmFsRGF0ZS51bml4KCksCiAgICAgICAgICBndWVzdHM6IHRoaXMuc3RheS5iYXNlR3Vlc3RzCiAgICAgICAgfTsKICAgICAgICB0ZW1wU3RheU5pZ2h0QXJyYXkucHVzaCh0ZW1wU3RheU5pZ2h0T2JqZWN0KTsKICAgICAgICB0ZW1wQXJyaXZhbERhdGUgPSB0ZW1wQXJyaXZhbERhdGUuYWRkKDEsICJkYXlzIik7CiAgICAgICAgaSsrOwogICAgICB9CgogICAgICByZXR1cm4gdGVtcFN0YXlOaWdodEFycmF5OwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgaHVtYW5Gb3JtYXREYXRldGltZTogZnVuY3Rpb24gaHVtYW5Gb3JtYXREYXRldGltZShkYXRlKSB7CiAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuZm9ybWF0KCJkZGQgRCBNTU0gWVlZWSAtIEhIOm1tIik7CiAgICB9LAogICAgZWRpdE5pZ2h0Q29udGVudFRleHRGb3JtYXQ6IGZ1bmN0aW9uIGVkaXROaWdodENvbnRlbnRUZXh0Rm9ybWF0KGRhdGUpIHsKICAgICAgcmV0dXJuIG1vbWVudC51bml4KGRhdGUpLmZvcm1hdCgiZGRkZCBEIik7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgY29tcHV0ZWRTdGF5OiB7CiAgICAgIC8vIFVwZGF0ZSBkZXBhcnR1cmUgZGF0ZSAobm90IHRpbWUpIGlmIHRoZSBhcnJpdmFsIGRhdGUgY2hhbmdlcwogICAgICBkZWVwOiB0cnVlLAogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKG5ld1N0YXksIG9sZFN0YXkpIHsKICAgICAgICB2YXIgb2xkU3RheUFycml2YWxEYXRldGltZSA9IG1vbWVudChvbGRTdGF5LmFycml2YWxEYXRldGltZSk7CiAgICAgICAgdmFyIG9sZFN0YXlEZXBhcnR1cmVEYXRldGltZSA9IG1vbWVudChvbGRTdGF5LmRlcGFydHVyZURhdGV0aW1lKTsKICAgICAgICB2YXIgbmV3U3RheUFycml2YWxEYXRldGltZSA9IG1vbWVudChuZXdTdGF5LmFycml2YWxEYXRldGltZSk7CiAgICAgICAgdmFyIG5ld1N0YXlEZXBhcnR1cmVEYXRldGltZSA9IG1vbWVudChuZXdTdGF5LmRlcGFydHVyZURhdGV0aW1lKTsKCiAgICAgICAgaWYgKG9sZFN0YXlBcnJpdmFsRGF0ZXRpbWUuZm9ybWF0KCJMTCIpICE9PSBuZXdTdGF5QXJyaXZhbERhdGV0aW1lLmZvcm1hdCgiTEwiKSAmIG9sZFN0YXlEZXBhcnR1cmVEYXRldGltZS5mb3JtYXQoIkxMIikgPT0gbmV3U3RheURlcGFydHVyZURhdGV0aW1lLmZvcm1hdCgiTEwiKSkgewogICAgICAgICAgdGhpcy5zdGF5LmRlcGFydHVyZURhdGV0aW1lID0gbmV3U3RheUFycml2YWxEYXRldGltZS5ob3VyKG9sZFN0YXlEZXBhcnR1cmVEYXRldGltZS5ob3VyKCkpLm1pbnV0ZShvbGRTdGF5RGVwYXJ0dXJlRGF0ZXRpbWUubWludXRlKCkpLnRvRGF0ZSgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zdGF5LnN0YXlOaWdodEFycmF5ID0gdGhpcy5zdGF5TmlnaHRBcnJheTsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"sources":["form-stay.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6HA,OAAA,MAAA,MAAA,QAAA;AAEA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,KAAA,MAAA,CAAA,KAAA,CAAA;AADA,KAAA;AAGA,GALA;AAMA,EAAA,QAAA,EAAA;AACA,IAAA,YAAA,EAAA,wBAAA;AACA,aAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,KAAA,IAAA,CAAA;AACA,KAHA;AAIA,IAAA,cAAA,EAAA,0BAAA;AACA,UAAA,kBAAA,GAAA,EAAA;AACA,UAAA,eAAA,GAAA,MAAA,CAAA,KAAA,IAAA,CAAA,eAAA,CAAA;AACA,UAAA,iBAAA,GAAA,MAAA,CAAA,KAAA,IAAA,CAAA,iBAAA,CAAA;AAEA,UAAA,CAAA,GAAA,CAAA;;AACA,aAAA,eAAA,GAAA,iBAAA,EAAA;AACA,YAAA,mBAAA,GAAA;AACA,UAAA,EAAA,EAAA,CADA;AAEA,UAAA,IAAA,EAAA,eAAA,CAAA,IAAA,EAFA;AAGA,UAAA,MAAA,EAAA,KAAA,IAAA,CAAA;AAHA,SAAA;AAKA,QAAA,kBAAA,CAAA,IAAA,CAAA,mBAAA;AACA,QAAA,eAAA,GAAA,eAAA,CAAA,GAAA,CAAA,CAAA,EAAA,MAAA,CAAA;AACA,QAAA,CAAA;AACA;;AACA,aAAA,kBAAA;AACA;AArBA,GANA;AA6BA,EAAA,OAAA,EAAA;AACA,IAAA,mBAAA,EAAA,6BAAA,IAAA,EAAA;AACA,aAAA,MAAA,CAAA,IAAA,CAAA,CAAA,MAAA,CAAA,wBAAA,CAAA;AACA,KAHA;AAIA,IAAA,0BAAA,EAAA,oCAAA,IAAA,EAAA;AACA,aAAA,MAAA,CAAA,IAAA,CAAA,IAAA,EAAA,MAAA,CAAA,QAAA,CAAA;AACA;AANA,GA7BA;AAqCA,EAAA,KAAA,EAAA;AACA,IAAA,YAAA,EAAA;AACA;AACA,MAAA,IAAA,EAAA,IAFA;AAGA,MAAA,OAAA,EAAA,iBAAA,OAAA,EAAA,OAAA,EAAA;AACA,YAAA,sBAAA,GAAA,MAAA,CAAA,OAAA,CAAA,eAAA,CAAA;AACA,YAAA,wBAAA,GAAA,MAAA,CAAA,OAAA,CAAA,iBAAA,CAAA;AACA,YAAA,sBAAA,GAAA,MAAA,CAAA,OAAA,CAAA,eAAA,CAAA;AACA,YAAA,wBAAA,GAAA,MAAA,CAAA,OAAA,CAAA,iBAAA,CAAA;;AACA,YACA,sBAAA,CAAA,MAAA,CAAA,IAAA,MACA,sBAAA,CAAA,MAAA,CAAA,IAAA,CADA,GAEA,wBAAA,CAAA,MAAA,CAAA,IAAA,KACA,wBAAA,CAAA,MAAA,CAAA,IAAA,CAJA,EAKA;AACA,eAAA,IAAA,CAAA,iBAAA,GAAA,sBAAA,CACA,IADA,CACA,wBAAA,CAAA,IAAA,EADA,EAEA,MAFA,CAEA,wBAAA,CAAA,MAAA,EAFA,EAGA,MAHA,EAAA;AAIA;;AACA,aAAA,IAAA,CAAA,cAAA,GAAA,KAAA,cAAA;AACA;AApBA;AADA;AArCA,CAAA","sourcesContent":["<template>\n  <div class=\"container\">\n    <!-- FORM SECTION TITLE -->\n    <h6 class=\"title is-6\">Nuitées</h6>\n    <!-- ARRIVAL -->\n    <b-field label=\"Check-in\" label-position=\"on-border\">\n      <b-datetimepicker\n        v-model=\"stay.arrivalDatetime\"\n        ref=\"arrivalDatetimePicker\"\n        placeholder=\"Check-in\"\n        :timepicker=\"{ incrementMinutes: 15 }\"\n        :datetime-formatter=\"humanFormatDatetime\"\n        :mobile-native=\"false\"\n      >\n        <template slot=\"right\">\n          <button\n            class=\"button is-success\"\n            @click=\"$refs.arrivalDatetimePicker.toggle()\"\n          >\n            <b-icon pack=\"fas\" icon=\"check\"></b-icon>\n            <span>Valider</span>\n          </button>\n        </template>\n      </b-datetimepicker>\n    </b-field>\n    <!-- DEPARTURE -->\n    <b-field label=\"Check-out\" label-position=\"on-border\">\n      <b-datetimepicker\n        v-model=\"stay.departureDatetime\"\n        ref=\"departureDatetimePicker\"\n        placeholder=\"Check-out\"\n        :timepicker=\"{ incrementMinutes: 15 }\"\n        :datetime-formatter=\"humanFormatDatetime\"\n        :mobile-native=\"false\"\n      >\n        <template slot=\"right\">\n          <button\n            class=\"button is-success\"\n            @click=\"$refs.departureDatetimePicker.toggle()\"\n          >\n            <b-icon pack=\"fas\" icon=\"check\"></b-icon>\n            <span>Valider</span>\n          </button>\n        </template>\n      </b-datetimepicker>\n    </b-field>\n\n    <!-- GUESTS -->\n    <b-field\n      label=\"Invités payants\"\n      label-position=\"on-border\"\n      message=\"2 ans et plus\"\n    >\n      <b-numberinput\n        icon-pack=\"fas\"\n        v-model=\"stay.baseGuests\"\n        min=\"10\"\n        controlsPosition=\"compact\"\n      ></b-numberinput>\n    </b-field>\n\n    <!-- CHILDREN -->\n    <b-field label=\"Enfants\" label-position=\"on-border\">\n      <b-numberinput\n        icon-pack=\"fas\"\n        v-model=\"stay.children\"\n        min=\"0\"\n        controlsPosition=\"compact\"\n      ></b-numberinput>\n    </b-field>\n\n    <!-- PETS -->\n    <b-field label=\"Animaux de compagnie\" label-position=\"on-border\">\n      <b-numberinput\n        icon-pack=\"fas\"\n        v-model=\"stay.pets\"\n        min=\"0\"\n        controlsPosition=\"compact\"\n      ></b-numberinput>\n    </b-field>\n\n    <!-- GUEST INFO -->\n    <b-field label=\"Informations supplémentaires\">\n      <b-input v-model=\"stay.guestInfo\" type=\"textarea\"></b-input>\n    </b-field>\n\n    <!-- GUEST DETAILED CONTROLS -->\n    <b-collapse :open=\"false\" class=\"card\" aria-id=\"editNightContent\">\n      <div\n        slot=\"trigger\"\n        class=\"card-header\"\n        role=\"button\"\n        aria-controls=\"editNightContent\"\n      >\n        <p class=\"card-header-title\">\n          {{ this.stay.stayNightArray.length }} nights\n        </p>\n        <a class=\"card-header-icon\">\n          <b-icon pack=\"fas\" icon=\"check\"></b-icon>\n        </a>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"content\">\n          <div v-for=\"night in stay.stayNightArray\" :key=\"night.id\">\n            <b-field grouped>\n              <b-field\n                style=\"width:100%;\"\n                :label=\"editNightContentTextFormat(night.date)\"\n                type=\"has-text-grey\"\n              >\n                <b-numberinput\n                  v-model=\"night.guests\"\n                  min=\"10\"\n                  controlsPosition=\"compact\"\n                ></b-numberinput>\n              </b-field>\n            </b-field>\n          </div>\n        </div>\n      </div>\n    </b-collapse>\n  </div>\n</template>\n\n<script>\nimport moment from \"moment\";\n\nexport default {\n  data() {\n    return {\n      stay: this.$store.state.stay\n    };\n  },\n  computed: {\n    computedStay: function() {\n      return Object.assign({}, this.stay);\n    },\n    stayNightArray: function() {\n      var tempStayNightArray = [];\n      var tempArrivalDate = moment(this.stay.arrivalDatetime);\n      var tempDepartureDate = moment(this.stay.departureDatetime);\n\n      var i = 0;\n      while (tempArrivalDate < tempDepartureDate) {\n        var tempStayNightObject = {\n          id: i,\n          date: tempArrivalDate.unix(),\n          guests: this.stay.baseGuests\n        };\n        tempStayNightArray.push(tempStayNightObject);\n        tempArrivalDate = tempArrivalDate.add(1, \"days\");\n        i++;\n      }\n      return tempStayNightArray;\n    }\n  },\n  methods: {\n    humanFormatDatetime: function(date) {\n      return moment(date).format(\"ddd D MMM YYYY - HH:mm\");\n    },\n    editNightContentTextFormat: function(date) {\n      return moment.unix(date).format(\"dddd D\");\n    }\n  },\n  watch: {\n    computedStay: {\n      // Update departure date (not time) if the arrival date changes\n      deep: true,\n      handler: function(newStay, oldStay) {\n        var oldStayArrivalDatetime = moment(oldStay.arrivalDatetime);\n        var oldStayDepartureDatetime = moment(oldStay.departureDatetime);\n        var newStayArrivalDatetime = moment(newStay.arrivalDatetime);\n        var newStayDepartureDatetime = moment(newStay.departureDatetime);\n        if (\n          (oldStayArrivalDatetime.format(\"LL\") !==\n            newStayArrivalDatetime.format(\"LL\")) &\n          (oldStayDepartureDatetime.format(\"LL\") ==\n            newStayDepartureDatetime.format(\"LL\"))\n        ) {\n          this.stay.departureDatetime = newStayArrivalDatetime\n            .hour(oldStayDepartureDatetime.hour())\n            .minute(oldStayDepartureDatetime.minute())\n            .toDate();\n        }\n        this.stay.stayNightArray = this.stayNightArray;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n@import \"@/scss/_mystyles.scss\";\n</style>\n"],"sourceRoot":"src/components"}]}