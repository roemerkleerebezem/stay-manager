(function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},s={index:0},n=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;n.push([0,"chunk-vendors","chunk-common"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0146":function(t,e,a){},1:function(t,e){},10:function(t,e){},11:function(t,e){},2:function(t,e){},2978:function(t,e,a){var i="stay-manager-calendar@stay-manager.iam.gserviceaccount.com",s=a("eea7").private_key,n="UTC+01:00",r={definitive:"q1sv3k7ot1lsooba6aoa1e88k0@group.calendar.google.com",cancelled:"aa55qd1t89q30584l0ksqfbr5g@group.calendar.google.com",inquiry:"6q4k1gilngdf9ofoeeemps7j64@group.calendar.google.com"};t.exports.serviceAcctId=i,t.exports.key=s,t.exports.timezone=n,t.exports.calendarIdList=r},3:function(t,e){},"3b43":function(t,e,a){"use strict";a("0146")},4:function(t,e){},4491:function(t,e,a){"use strict";a("4963")},4963:function(t,e,a){},5:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("8c4f"),s=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},r=[],o={components:{},methods:{}},l=o,c=a("2877"),u=Object(c["a"])(l,n,r,!1,null,null,null),d=u.exports,p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"app-section"},[[i("b-navbar",{staticClass:"is-dark",attrs:{"fixed-top":""}},[i("template",{slot:"brand"},[i("b-navbar-item",{attrs:{href:"/"}},[i("img",{attrs:{src:a("5f60")}}),i("span",{staticClass:"navbar-item has-text-light"},[t._v("Moulin du Merle stay-manager")])])],1),i("template",{slot:"start"}),i("template",{slot:"end"},[i("b-navbar-item",{attrs:{tag:"div"}},[i("div",{staticClass:"buttons"},[i("b-tooltip",{attrs:{type:t.dataReady?"is-success":"is-warning",label:t.dataReady?"Save the booking":"Missing information, either booking status or dates",position:"is-left",size:"is-large",multilined:""}},[i("b-button",{class:t.synced?"is-success":"is-warning",attrs:{disabled:t.synced||!t.dataReady},on:{click:function(e){return t.getApi(t.state,"save")}}},[t._v(t._s(t.synced?"Saved":"Save"))])],1)],1)])],1)],2)],i("b-tabs",{key:t.updateTab,staticClass:"has-text-weight-medium",attrs:{id:"sheetTabs",size:"is-medium is-boxed",expanded:""},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[i("b-tab-item",{attrs:{label:"Reservation"}},[i("reservation-tab")],1),i("b-tab-item",{attrs:{label:"Restauration"}},[i("catering-tab")],1),i("b-tab-item",{attrs:{label:"Facture"}},[i("invoice-tab")],1),i("b-tab-item",{attrs:{label:"Settings"}},[i("settings-tab")],1)],1),i("b-modal",{attrs:{active:t.isStoreModalActive,"has-modal-card":"","destroy-on-hide":!1,"trap-focus":"",scroll:"keep"},on:{"update:active":function(e){t.isStoreModalActive=e}}},[i("div",{staticClass:"modal-card"},[i("header",{staticClass:"modal-card-head"},[i("p",{staticClass:"modal-card-title"},[t._v("Booking data")]),i("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){t.isDepositModalActive=!1}}})]),i("section",{staticClass:"modal-card-body"},t._l(t.state,(function(e,a){return i("div",{key:a},[i("span",{staticClass:"tag is-dark is-small"},[t._v(t._s(a))]),i("pre",[t._v(t._s(e))])])})),0)])]),i("footer",{staticClass:"footer has-background-dark level"},[i("div",{staticClass:"level-left"},[i("div",{staticClass:"level-item"},[i("b-checkbox",{staticClass:"has-text-light is-pulled-left is-family-code",attrs:{type:"is-danger",size:"is-medium"},model:{value:t.devIsTrue,callback:function(e){t.devIsTrue=e},expression:"devIsTrue"}},[t._v("DO NOT UPDATE CALENDAR")])],1)]),i("div",{staticClass:"level-right"},[i("div",{staticClass:"level-item"},[i("b-button",{staticClass:"is-family-code",on:{click:function(e){t.isStoreModalActive=!0}}},[t._v("Show booking details")])],1)])])],2)},m=[],b=a("3835"),h=a("1da1"),v=(a("e9c4"),a("4160"),a("d3b7"),a("159b"),a("caad"),a("2532"),a("a4d3"),a("e01a"),a("99af"),a("4fad"),a("3ca3"),a("ddb0"),a("d81d"),a("b0c0"),a("96cf"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"section"},[a("div",{staticClass:"container"},[t._m(0),a("div",{staticClass:"box"},[a("form-booking",{staticClass:"form-section"})],1),a("div",{staticClass:"box"},[a("form-contact",{staticClass:"form-section"})],1),a("div",{staticClass:"box"},[a("form-stay",{staticClass:"form-section"})],1)])])}),f=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("h3",{staticClass:"title is-3"},[t._v("Reservation")])])}],g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[t._m(0),a("div",{staticClass:"subsection"},[a("b-field",{attrs:{label:"Email","label-position":"on-border"}},[a("b-input",{attrs:{type:"email",placeholder:"Email"},model:{value:t.contact.email,callback:function(e){t.$set(t.contact,"email",e)},expression:"contact.email"}})],1),a("b-field",{attrs:{label:"Nom","label-position":"on-border"}},[a("b-input",{attrs:{placeholder:"Nom"},model:{value:t.contact.name,callback:function(e){t.$set(t.contact,"name",e)},expression:"contact.name"}})],1),a("b-field",{attrs:{label:"Téléphone","label-position":"on-border"}},[a("b-input",{attrs:{placeholder:"Téléphone"},model:{value:t.contact.phone,callback:function(e){t.$set(t.contact,"phone",e)},expression:"contact.phone"}})],1),a("b-field",{attrs:{label:"Nationalité","label-position":"on-border"}},[a("b-select",{attrs:{placeholder:"Nationalité"},model:{value:t.contact.nationality,callback:function(e){t.$set(t.contact,"nationality",e)},expression:"contact.nationality"}},[a("option",{attrs:{value:"french"}},[t._v("Francais")]),a("option",{attrs:{value:"dutch"}},[t._v("Néerlandais")]),a("option",{attrs:{value:"german"}},[t._v("Allemand")]),a("option",{attrs:{value:"other"}},[t._v("Autre")])])],1),a("b-field",{attrs:{label:"Avis","label-position":""}},[a("b-rate",{attrs:{"icon-pack":"fas","custom-text":""},model:{value:t.contact.rating,callback:function(e){t.$set(t.contact,"rating",e)},expression:"contact.rating"}})],1)],1)])},y=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-light"},[a("h5",{staticClass:"is-size-5 subtitle has-text-dark has-text-weight-medium"},[t._v(" Contact ")])])}],x={data:function(){return{contact:this.$store.state.contact}},computed:{}},k=x,C=Object(c["a"])(k,g,y,!1,null,"452df544",null),_=C.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[t._m(0),a("div",{staticClass:"subsection"},[a("b-field",{attrs:{type:t.getStatusColor(t.booking.status),"custom-class":"is-medium",label:"Statut","label-position":"on-border"}},[a("b-select",{attrs:{size:"is-medium",placeholder:"Select a type"},model:{value:t.booking.status,callback:function(e){t.$set(t.booking,"status",e)},expression:"booking.status"}},[a("option",{attrs:{value:"inquiry"}},[t._v("Inquiry")]),a("option",{attrs:{value:"contract"}},[t._v("Definitive")]),a("option",{attrs:{value:"completed"}},[t._v("Completed")]),a("option",{attrs:{value:"cancelled"}},[t._v("Cancelled")])])],1),a("b-field",{attrs:{label:"Source","label-position":"on-border"}},[a("b-select",{attrs:{placeholder:"Source"},model:{value:t.booking.source,callback:function(e){t.$set(t.booking,"source",e)},expression:"booking.source"}},[a("option",{attrs:{value:"airbnb"}},[t._v("AirBnb")]),a("option",{attrs:{value:"homeaway"}},[t._v("HomeAway")]),a("option",{attrs:{value:"direct"}},[t._v("Direct")]),a("option",{attrs:{value:"other"}},[t._v("Autre")])])],1),a("b-field",{attrs:{label:"Date de réservation"}},[a("b-datepicker",{ref:"bookingDatePicker",attrs:{"icon-pack":"fas","first-day-of-week":1,placeholder:"Date de réservation"},model:{value:t.booking.date,callback:function(e){t.$set(t.booking,"date",e)},expression:"booking.date"}},[a("button",{staticClass:"button is-success",on:{click:function(e){return t.$refs.bookingDatePicker.toggle()}}},[a("b-icon",{attrs:{pack:"fas",icon:"check"}}),a("span",[t._v("Valider")])],1)])],1)],1)])},S=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-light"},[a("h5",{staticClass:"is-size-5 subtitle has-text-dark has-text-weight-medium"},[t._v(" Information ")])])}],A=a("c1df"),w=a.n(A),T={props:{},data:function(){return{booking:this.$store.state.booking}},computed:{bookingDate:function(){var t=null==this.booking.date?null:w()(this.booking.date).toDate();return console.log(this.booking.date),t}},methods:{getStatusColor:function(t){return"inquiry"===t?"is-warning":"contract"===t||"completed"===t?"is-success":"is-grey"}}},N=T,I=Object(c["a"])(N,D,S,!1,null,"6c183928",null),P=I.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[t._m(0),a("div",{staticClass:"columns subsection"},[a("div",{staticClass:"column is-9"},[a("div",{staticClass:"buttons"},[a("b-button",{staticClass:"is-size-5 has-text-dark has-text-weight-bold",attrs:{"icon-pack":"fas","icon-left":"plus-circle",type:"is-light",expanded:""},on:{click:function(e){return t.addDays(!0)}}},[t._v(t._s(t.dayBefore))])],1),t._l(t.stay.stayNightArray,(function(e){return a("article",{key:e.id,staticClass:"message is-dark"},[a("b-collapse",{attrs:{animation:"slide","aria-id":"nightAria"+e.id,open:!1}},[a("div",{staticClass:"message-header",attrs:{slot:"trigger",role:"button","aria-controls":"nightAria"+e.id,"aria-close-label":"Close message"},slot:"trigger"},[a("p",{staticClass:"is-size-5 has-text-light has-text-weight-bold"},[t._v(" "+t._s(t.editNightContentTextFormat(e.date))+" - "),e.internal.adults+e.external.adults>0?a("span",[a("div",{staticClass:"tag has-text-weight-normal"},[t._v("ADULTS")]),t._v(" "+t._s(e.internal.adults+e.external.adults)+" "),a("span",{staticClass:"has-text-weight-normal"},[t._v("("+t._s(e.external.adults)+" + "+t._s(e.internal.adults)+")")])]):t._e(),t._v("   "),e.internal.kids+e.external.kids>0?a("span",[a("div",{staticClass:"tag has-text-weight-normal"},[t._v("KIDS")]),t._v(" "+t._s(e.external.kids+e.internal.kids)+" "),a("span",{staticClass:"has-text-weight-normal"},[t._v("("+t._s(e.external.kids)+" + "+t._s(e.internal.kids)+")")])]):t._e(),t._v("   "),e.internal.infants+e.external.infants>0?a("span",[a("div",{staticClass:"tag has-text-weight-normal"},[t._v("INFANTS")]),t._v("   "+t._s(e.external.infants+e.internal.infants)+" ")]):t._e(),e.internal.pets+e.external.pets>0?a("span",[a("div",{staticClass:"tag has-text-weight-normal"},[t._v("PETS")]),t._v(" "+t._s(e.internal.pets+e.external.pets))]):t._e()]),e==t.stay.stayNightArray[0]&&e!=t.stay.stayNightArray[t.stay.stayNightArray.length-1]?a("button",{staticClass:"delete is-medium",attrs:{type:"is-danger"},on:{click:function(e){return t.deleteDay(!0)}}}):t._e(),e==t.stay.stayNightArray[t.stay.stayNightArray.length-1]&&e!=t.stay.stayNightArray[0]?a("button",{staticClass:"delete is-medium",attrs:{type:"is-danger"},on:{click:function(e){return t.deleteDay(!1)}}}):t._e()]),a("div",{staticClass:"message-body"},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th"),a("th",[t._v("Platform")]),a("th",[t._v("Direct")])])]),a("tbody",[a("tr",[a("td",[a("p",[t._v("VILLA")])]),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.external.villa,callback:function(a){t.$set(e.external,"villa",a)},expression:"night.external.villa"}})],1),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.internal.villa,callback:function(a){t.$set(e.internal,"villa",a)},expression:"night.internal.villa"}})],1),e.external.villa+e.internal.villa!=1?a("td",[a("span",{staticClass:"has-text-weight-bold has-text-danger"},[t._v(" WARNING: set villa to either internal or external ")])]):t._e()]),a("tr",[a("td",[t._v("ADULTS")]),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.external.adults,callback:function(a){t.$set(e.external,"adults",a)},expression:"night.external.adults"}})],1),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.internal.adults,callback:function(a){t.$set(e.internal,"adults",a)},expression:"night.internal.adults"}})],1),e.external.villa>0&0==e.external.adults?a("td",[a("span",{staticClass:"has-text-weight-bold has-text-danger"},[t._v(" WARNING: there is external villa but no external guests ")])]):t._e()]),a("tr",[a("td",[t._v("KIDS")]),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.external.kids,callback:function(a){t.$set(e.external,"kids",a)},expression:"night.external.kids"}})],1),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.internal.kids,callback:function(a){t.$set(e.internal,"kids",a)},expression:"night.internal.kids"}})],1)]),a("tr",[a("td",[t._v("INFANTS")]),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.external.infants,callback:function(a){t.$set(e.external,"infants",a)},expression:"night.external.infants"}})],1),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.internal.infants,callback:function(a){t.$set(e.internal,"infants",a)},expression:"night.internal.infants"}})],1)]),a("tr",[a("td",[t._v("PETS")]),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.external.pets,callback:function(a){t.$set(e.external,"pets",a)},expression:"night.external.pets"}})],1),a("td",[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0","controls-rounded":"",type:"is-light"},model:{value:e.internal.pets,callback:function(a){t.$set(e.internal,"pets",a)},expression:"night.internal.pets"}})],1)])])]),a("b-button",{staticClass:"button is-dark",attrs:{"icon-pack":"fas","icon-left":"arrow-down",outlined:""},on:{click:function(a){return t.cloneNightToNext(e.id)}}},[a("span",{staticClass:"has-text-weight-bold"},[t._v("Apply to all following nights")])])],1)])],1)})),a("div",{staticClass:"buttons"},[a("b-button",{staticClass:"is-size-5 has-text-dark has-text-weight-bold",attrs:{"icon-pack":"fas","icon-left":"plus-circle",type:"is-light",expanded:""},on:{click:function(e){return t.addDays(!1)}}},[t._v(t._s(t.dayAfter))])],1)],2),a("div",{staticClass:"column is-3"},[a("b-field",{attrs:{label:"Check-in","label-position":"on-border"}},[a("b-datepicker",{ref:"arrivalDatePicker",attrs:{"icon-pack":"fas",datepicker:{"first-day-of-week":1},placeholder:"Check-in","date-formatter":t.humanFormatDate,"mobile-native":!1},on:{input:function(e){return t.changeArrivalDate()}},model:{value:t.tempArrivalDate,callback:function(e){t.tempArrivalDate=e},expression:"tempArrivalDate"}},[a("button",{staticClass:"button is-success",on:{click:function(e){return t.$refs.arrivalDatePicker.toggle()}}},[a("b-icon",{attrs:{pack:"fas",icon:"check"}}),a("span",[t._v("Valider")])],1)])],1),a("b-field",[a("b-timepicker",{attrs:{incrementMinutes:15,inline:""},on:{input:function(e){return t.changeTime("arrival")}},model:{value:t.tempArrivalTime,callback:function(e){t.tempArrivalTime=e},expression:"tempArrivalTime"}}),0!=t.extraHours.arrival?a("b-tag",{attrs:{type:t.extraHours.arrival>0?"is-danger is-light":"is-success is-light"}},[t._v(" "+t._s(t.extraHours.arrival>0?"+"+t.extraHours.arrival:t.extraHours.arrival)+" ")]):t._e()],1),a("b-field",{attrs:{label:"Check-out","label-position":"on-border"}},[a("b-datepicker",{ref:"departureDatePicker",attrs:{"icon-pack":"fas",datepicker:{"first-day-of-week":1},placeholder:"Check-out","date-formatter":t.humanFormatDate,"mobile-native":!1},on:{input:function(e){return t.changeDepartureDate()}},model:{value:t.tempDepartureDate,callback:function(e){t.tempDepartureDate=e},expression:"tempDepartureDate"}},[a("button",{staticClass:"button is-success",on:{click:function(e){return t.$refs.departureDatePicker.toggle()}}},[a("b-icon",{attrs:{pack:"fas",icon:"check"}}),a("span",[t._v("Valider")])],1)])],1),a("b-field",[a("b-timepicker",{attrs:{incrementMinutes:15,inline:""},on:{input:function(e){return t.changeTime("departure")}},model:{value:t.tempDepartureTime,callback:function(e){t.tempDepartureTime=e},expression:"tempDepartureTime"}}),0!=t.extraHours.departure?a("b-tag",{attrs:{type:t.extraHours.departure>0?"is-danger is-light":"is-success is-light"}},[t._v(" "+t._s(t.extraHours.departure>0?"+"+t.extraHours.departure:t.extraHours.departure)+" ")]):t._e()],1),a("b-field",{attrs:{label:"Informations supplémentaires"}},[a("b-input",{attrs:{type:"textarea"},model:{value:t.stay.guestInfo,callback:function(e){t.$set(t.stay,"guestInfo",e)},expression:"stay.guestInfo"}})],1)],1)])])},E=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-light"},[a("h5",{staticClass:"is-size-5 subtitle has-text-dark has-text-weight-medium"},[t._v(" Nuitées ")])])}],M=(a("7db0"),{data:function(){return{stay:this.$store.state.stay,stayNightArray:[],tempArrivalDate:w.a.unix(this.$store.state.stay.arrivalDate).toDate(),tempArrivalTime:w.a.unix(this.$store.state.stay.arrivalTime).toDate(),tempDepartureDate:w.a.unix(this.$store.state.stay.departureDate).toDate(),tempDepartureTime:w.a.unix(this.$store.state.stay.departureTime).toDate()}},computed:{dayBefore:function(){return this.editNightContentTextFormat(w.a.unix(this.stay.arrivalDate).add(-1,"days").unix())},dayAfter:function(){return this.editNightContentTextFormat(w.a.unix(this.stay.departureDate).unix())},extraHours:function(){var t=w()(this.tempArrivalTime),e=w()(this.tempDepartureTime),a=this.$store.state.settings.minArrivalTime,i=this.$store.state.settings.maxDepartureTime,s=w()().hours(a.hour).minute(a.minute).diff(w()().hours(t.hour()).minute(t.minute()),"hours"),n=w()().hours(e.hour()).minute(e.minute()).diff(w()().hours(i.hour).minute(i.minute),"hours");return{arrival:s,departure:n}}},methods:{humanFormatDate:function(t){return w()(t).format("ddd D MMM YYYY")},editNightContentTextFormat:function(t){return w.a.unix(t).format("dddd D")},cloneNightToNext:function(t){var e=this.stay.stayNightArray,a=JSON.parse(JSON.stringify(e.find((function(e){return e.id==t}))));e.forEach((function(t){t.id>a.id&&(t.internal=JSON.parse(JSON.stringify(a.internal)),t.external=JSON.parse(JSON.stringify(a.external)))}))},setStayNightArray:function(){var t=[],e=w.a.unix(this.stay.arrivalDate),a=w.a.unix(this.stay.departureDate),i=100;while(e.clone().startOf("day")<a.clone().startOf("day")){var s={id:i,date:e.unix(),internal:{villa:1,adults:10,kids:0,infants:0,pets:0},external:{villa:0,adults:0,kids:0,infants:0,pets:0}};t.push(s),e=e.add(1,"days"),i++}return t},changeArrivalDate:function(){var t=w()(this.tempArrivalDate).diff(w.a.unix(this.stay.arrivalDate),"days");0!=t&&this.offsetNightArray(t)},changeTime:function(t){"arrival"==t?this.stay.arrivalTime=w()(this.tempArrivalTime).unix():this.stay.departureTime=w()(this.tempDepartureTime).unix()},changeDepartureDate:function(){var t=w()(this.tempDepartureDate).diff(w.a.unix(this.stay.departureDate),"days"),e=this.stay.stayNightArray.length;if(console.log("offset : "+t),0!=t)if(t>0&&1==e){this.tempDepartureDate=w.a.unix(this.stay.departureDate).toDate();var a=0;while(a<t)console.log(a),this.addDays(!1),a+=1}else this.offsetNightArray(t)},addDays:function(t){var e=this.stay.stayNightArray;if(t){var a=JSON.parse(JSON.stringify(e[0]));a.id=a.id-1,a.date=w.a.unix(a.date).add(-1,"days").unix(),e.unshift(a),this.stay.arrivalDate=w()(this.tempArrivalDate).add(-1,"days").unix(),this.tempArrivalDate=w.a.unix(this.stay.arrivalDate).toDate()}if(0==t){a=JSON.parse(JSON.stringify(e[e.length-1]));a.id=a.id+1,a.date=w.a.unix(a.date).add(1,"days").unix(),e.push(a),this.stay.departureDate=w()(this.tempDepartureDate).add(1,"days").unix(),this.tempDepartureDate=w.a.unix(this.stay.departureDate).toDate()}},deleteDay:function(t){var e=this.stay.stayNightArray;t&&(e.shift(),this.stay.arrivalDate=w.a.unix(this.stay.arrivalDate).add(1,"days").unix(),this.tempArrivalDate=w.a.unix(this.stay.arrivalDate).toDate()),0==t&&(e.pop(),this.stay.departureDate=w.a.unix(this.stay.departureDate).add(-1,"days").unix(),this.tempDepartureDate=w.a.unix(this.stay.departureDate).toDate())},offsetNightArray:function(t){var e=this.stay;e.arrivalDate=w.a.unix(e.arrivalDate).add(t,"days").unix(),e.departureDate=w.a.unix(e.departureDate).add(t,"days").unix(),e.stayNightArray.forEach((function(e){e.date=w.a.unix(e.date).add(t,"days").unix()})),this.tempArrivalDate=w.a.unix(e.arrivalDate).toDate(),this.tempDepartureDate=w.a.unix(e.departureDate).toDate()}},watch:{}}),O=M,j=(a("4491"),Object(c["a"])(O,$,E,!1,null,null,null)),R=j.exports,F={components:{formContact:_,formBooking:P,formStay:R},data:function(){return{}},computed:{stay:function(){return this.$store.state.stay},booking:function(){return this.$store.state.booking},contact:function(){return this.$store.state.contact}},watch:{},methods:{}},J=F,q=Object(c["a"])(J,v,f,!1,null,null,null),V=q.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"section"},[a("div",{staticClass:"container"},[t._m(0),t._l(t.meals,(function(e){return a("b-collapse",{key:e.id,staticClass:"card meal-card",attrs:{"aria-id":"mealContent"+e.id,open:!1}},[a("div",{staticClass:"card-header",attrs:{slot:"trigger",role:"button","aria-controls":"mealContent"+e.id},slot:"trigger"},[a("p",{staticClass:"card-header-title is-size-5"},[a("span",{staticClass:"is-uppercase"},[t._v(t._s(e.type))]),a("span",{staticClass:"has-text-dark-grey"},[t._v(" -"+t._s(e.adults*e.adultPrice+e.children*e.childPrice)+" euros ")])]),a("b-button",{attrs:{"icon-pack":"fas",type:"is-medium is-danger","icon-left":"times"},on:{click:function(a){t.$delete(t.meals,t.meals.indexOf(e))}}})],1),a("div",{staticClass:"card-content"},[a("b-field",{attrs:{label:"Date","label-position":"on-border"}},[a("b-datepicker",{attrs:{"icon-pack":"fas","first-day-of-week":1,placeholder:"Date du repas"},model:{value:e.date,callback:function(a){t.$set(e,"date",a)},expression:"meal.date"}})],1),a("b-field",{attrs:{grouped:"","group-multiline":""}},[a("b-field",{attrs:{label:"Adultes","label-position":"on-border"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0",controlsPosition:"compact"},model:{value:e.adults,callback:function(a){t.$set(e,"adults",a)},expression:"meal.adults"}})],1),a("b-field",{attrs:{label:"Prix adulte","label-position":"on-border"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",step:"0.5","min-step":"0.01",min:"0",controlsPosition:"compact"},model:{value:e.adultPrice,callback:function(a){t.$set(e,"adultPrice",a)},expression:"meal.adultPrice"}})],1)],1),a("b-field",{attrs:{grouped:"","group-multiline":""}},[a("b-field",{attrs:{label:"Enfants","label-position":"on-border"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",min:"0",controlsPosition:"compact"},model:{value:e.children,callback:function(a){t.$set(e,"children",a)},expression:"meal.children"}})],1),a("b-field",{attrs:{label:"Prix enfant","label-position":"on-border"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",step:"0.5","min-step":"0.01",min:"0",controlsPosition:"compact"},model:{value:e.childPrice,callback:function(a){t.$set(e,"childPrice",a)},expression:"meal.childPrice"}})],1)],1),a("b-field",{attrs:{label:"Contenu","label-position":"on-border"}},[a("b-input",{attrs:{type:"textarea"},model:{value:e.information,callback:function(a){t.$set(e,"information",a)},expression:"meal.information"}})],1),a("hr"),t._l(e.costs,(function(i){return a("b-collapse",{key:i.id,staticClass:"card meal-card",attrs:{open:!1,"aria-id":"costContent"+i.id}},[a("div",{staticClass:"card-header",attrs:{slot:"trigger",role:"button","aria-controls":"costContent"+i.id},slot:"trigger"},[a("p",{staticClass:"card-header-title"},[t._v(" "+t._s(i.name)+" : "+t._s(i.totalPrice)+" euros ")]),a("b-button",{attrs:{"icon-pack":"fas",type:"is-small is-light","icon-left":"times"},on:{click:function(a){t.$delete(e.costs,e.costs.indexOf(i))}}})],1),a("div",{staticClass:"card-content"},t._l(i,(function(e,i){return a("div",{key:i},[a("span",{staticClass:"tag is-dark is-small"},[t._v(t._s(i))]),a("pre",[t._v(t._s(e))])])})),0)])})),a("b-button",{on:{click:function(e){t.isCateringCostModalActive=!0}}},[t._v("Add Cost")]),a("b-modal",{attrs:{active:t.isCateringCostModalActive,"has-modal-card":"","destroy-on-hide":!1,width:"50%","trap-focus":"",scroll:"keep"},on:{"update:active":function(e){t.isCateringCostModalActive=e}}},[a("div",{staticClass:"modal-card"},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Add transaction")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){t.isCateringCostModalActive=!1}}})]),a("section",{staticClass:"modal-card-body"},[a("b-field",{attrs:{grouped:"","group-multiline":""}},[a("b-field",{attrs:{label:"Type"}},[a("b-select",{attrs:{placeholder:"Select a type"},model:{value:e.tempCost.type,callback:function(a){t.$set(e.tempCost,"type",a)},expression:"meal.tempCost.type"}},[a("option",{attrs:{value:"caterer"}},[t._v("Restaurateur")]),a("option",{attrs:{value:"groceries"}},[t._v("Courses")])])],1),a("b-field",{attrs:{label:"Nom"}},[a("b-input",{model:{value:e.tempCost.name,callback:function(a){t.$set(e.tempCost,"name",a)},expression:"meal.tempCost.name"}})],1),a("b-field",{attrs:{label:"Unités"}},[a("b-input",{model:{value:e.tempCost.units,callback:function(a){t.$set(e.tempCost,"units",a)},expression:"meal.tempCost.units"}})],1),a("b-field",{attrs:{label:"Prix unitaire"}},[a("b-input",{model:{value:e.tempCost.unitPrice,callback:function(a){t.$set(e.tempCost,"unitPrice",a)},expression:"meal.tempCost.unitPrice"}})],1),a("b-field",{attrs:{label:"Prix total"}},[a("b-numberinput",{attrs:{controls:!1,"icon-pack":"fas","controls-position":"compact",step:"0.01"},model:{value:e.tempCost.totalPrice,callback:function(a){t.$set(e.tempCost,"totalPrice",a)},expression:"meal.tempCost.totalPrice"}})],1)],1),a("b-field",{attrs:{label:"Informations supplémentaires","label-position":"on-border"}},[a("b-input",{attrs:{type:"textarea"},model:{value:e.tempCost.information,callback:function(a){t.$set(e.tempCost,"information",a)},expression:"meal.tempCost.information"}})],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("b-button",{attrs:{type:"is-primary"},on:{click:function(a){return t.addCost(e.id)}}},[t._v("Ajouter")])],1)])])],2)])})),a("div",{staticClass:"box"},[a("h5",{staticClass:"title is-5"},[t._v(" Ajouter repas "),a("b-dropdown",{staticClass:"is-pulled-right",attrs:{"aria-role":"list"}},[a("button",{staticClass:"button is-light is-small",attrs:{slot:"trigger"},slot:"trigger"},[a("b-icon",{attrs:{pack:"fas",icon:"plus",size:"is-medium"}})],1),a("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(e){return t.addMeal("breakfast")}}},[t._v("Petit-dejeuner")]),a("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(e){return t.addMeal("lunch")}}},[t._v("Déjeuner")]),a("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(e){return t.addMeal("dinner")}}},[t._v("Dîner")])],1)],1)])],2)])},L=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box "},[a("h3",{staticClass:"title is-3"},[t._v("Restauration")])])}],U=(a("ac1f"),a("5319"),a("d401"),a("0d03"),a("25f0"),{components:{},data:function(){return{meals:this.$store.state.meals,isCateringCostModalActive:!1}},computed:{},watch:{},methods:{addMeal:function(t){var e={id:this.uuidv4(),type:t,adults:10,children:0,adultPrice:17.5,childPrice:15,information:null,tempCost:{type:null,name:null,units:null,unitPrice:null,totalPrice:null,information:null},costs:[]};this.meals.push(e)},uuidv4:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,a="x"==t?e:3&e|8;return a.toString(16)}))},addCost:function(t){var e=this.meals.find((function(e){return e.id===t})),a=e.costs;e.tempCost.id=this.uuidv4(),a.push(e.tempCost),s["a"].set(e,"costs",JSON.parse(JSON.stringify(a))),e.tempCost={type:null,name:null,units:null,unitPrice:null,totalPrice:null,information:null},this.isCateringCostModalActive=!1}}}),z=U,B=(a("e74b"),Object(c["a"])(z,Y,L,!1,null,"02706809",null)),H=B.exports,K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"section",staticStyle:{height:"100%"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"box"},[a("b-field",{attrs:{grouped:""}},[a("h3",{staticClass:"title is-3 control"},[t._v("Facture n°")]),a("b-numberinput",{staticStyle:{width:"3rem"},attrs:{"icon-pack":"fas",min:"0",controls:!1},model:{value:t.booking.invoiceNumber,callback:function(e){t.$set(t.booking,"invoiceNumber",e)},expression:"booking.invoiceNumber"}})],1)],1),a("div",{staticClass:"box"},[t._m(0),a("div",{staticClass:"subsection"},[a("label",{staticClass:"label"},[t._v("Caution")]),t._l(t.booking.deposits,(function(e){return a("div",{key:e.id,staticClass:"container",staticStyle:{"margin-bottom":"1rem"}},[a("article",{staticClass:"message is-light"},[a("div",{staticClass:"message-header"},[a("p",[a("b-icon",{staticStyle:{"margin-right":"0.5ch",display:"inline-table"},attrs:{pack:"fas",icon:t.getDepositIcon(e.type),size:"is-medium",type:"is-grey"}}),a("span",{staticClass:"has-text-grey"},[t._v(t._s(e.type)+" -")]),t._v(" "+t._s(e.amount)+" euros ")],1),a("span",{class:"tag is-medium "+("pending"===e.status?"is-warning":"is-success")},[t._v(" "+t._s(null===e.dateReceived?"":e.dateReceived.toString().substring(0,10)+", ")+" "+t._s(e.status)+" ")]),a("div",{staticClass:"buttons"},[a("b-button",{attrs:{"icon-pack":"fas","icon-left":"pencil-alt",type:"is-dark"},on:{click:function(a){return t.editDeposit(e)}}}),a("b-button",{attrs:{"icon-pack":"fas",type:" is-danger","icon-left":"trash"},on:{click:function(a){t.$delete(t.booking.deposits,t.booking.deposits.indexOf(e))}}})],1)])])])})),a("div",{staticClass:"container"},[a("b-button",{on:{click:function(e){t.isDepositModalActive=!0}}},[t._v("Ajouter caution")]),a("b-modal",{attrs:{active:t.isDepositModalActive,"has-modal-card":"","destroy-on-hide":!1,width:"50%","trap-focus":"",scroll:"keep"},on:{"update:active":function(e){t.isDepositModalActive=e}}},[a("div",{staticClass:"modal-card"},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Ajouter caution")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){t.isDepositModalActive=!1}}})]),a("section",{staticClass:"modal-card-body"},[a("b-field",{attrs:{label:"Type","label-position":"on-border"}},[a("b-select",{attrs:{placeholder:"Select a type"},model:{value:t.tempDeposit.type,callback:function(e){t.$set(t.tempDeposit,"type",e)},expression:"tempDeposit.type"}},[a("option",{attrs:{value:"cheque"}},[t._v("Cheque")]),a("option",{attrs:{value:"transfer"}},[t._v("Virement")]),a("option",{attrs:{value:"cash"}},[t._v("Liquide")])])],1),a("b-field",{attrs:{label:"Statut","label-position":"on-border"}},[a("b-select",{attrs:{placeholder:"Select a status"},model:{value:t.tempDeposit.status,callback:function(e){t.$set(t.tempDeposit,"status",e)},expression:"tempDeposit.status"}},[a("option",{attrs:{value:"pending"}},[t._v("En attente")]),a("option",{attrs:{value:"received"}},[t._v("Recu")]),a("option",{attrs:{value:"returned"}},[t._v("Rendu")])])],1),a("b-field",{attrs:{label:"Montant","label-position":"on-border"}},[a("b-input",{attrs:{placeholder:"300"},model:{value:t.tempDeposit.amount,callback:function(e){t.$set(t.tempDeposit,"amount",e)},expression:"tempDeposit.amount"}})],1),a("b-field",{attrs:{label:"Date reception","label-position":"on-border"}},[a("b-datepicker",{attrs:{inline:"","first-day-of-week":1,"icon-pack":"fas",placeholder:"Date de reception"},model:{value:t.tempDeposit.dateReceived,callback:function(e){t.$set(t.tempDeposit,"dateReceived",e)},expression:"tempDeposit.dateReceived"}})],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("b-button",{attrs:{disabled:0==t.canAddDeposit,type:"is-primary"},on:{click:function(e){return t.addDeposit()}}},[t._v("Ajouter")])],1)])])],1),a("div",{staticClass:"container"},[a("hr"),a("label",{staticClass:"label"},[t._v("Transactions supplémentaires")]),t._l(t.booking.costs,(function(e){return a("div",{key:e.id,staticClass:"container",staticStyle:{"margin-bottom":"1rem"}},[a("article",{staticClass:"message is-light"},[a("div",{staticClass:"message-header"},[a("p",[a("b-icon",{staticStyle:{"margin-right":"0.5ch",display:"inline-table"},attrs:{pack:"fas",icon:"cost"===e.type?"arrow-down":"arrow-up",size:"is-medium",type:"is-grey"}}),t._v(" "+t._s(e.label)+" "),a("span",{staticClass:"has-text-grey"},[t._v(t._s(e.units)+" x "+t._s(e.unitPrice)+" €")])],1),a("span",{class:"tag "+("cost"===e.type?"is-danger":"is-success")},[t._v(" "+t._s("cost"===e.type?"-":"+")+" "+t._s(e.totalPrice)+" € ")]),a("div",{staticClass:"buttons"},[a("b-button",{attrs:{"icon-pack":"fas","icon-left":"pencil-alt",type:"is-dark"},on:{click:function(a){return t.editCost(e)}}}),a("b-button",{attrs:{"icon-pack":"fas",type:" is-danger","icon-left":"trash"},on:{click:function(a){t.$delete(t.booking.costs,t.booking.costs.indexOf(e))}}})],1)])])])})),a("b-button",{on:{click:function(e){t.isTransactionModalActive=!0}}},[t._v("Add transaction")]),a("b-modal",{attrs:{active:t.isTransactionModalActive,"has-modal-card":"","destroy-on-hide":!1,width:"50%","trap-focus":"",scroll:"keep"},on:{"update:active":function(e){t.isTransactionModalActive=e}}},[a("div",{staticClass:"modal-card"},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Add transaction")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){t.isTransactionModalActive=!1}}})]),a("section",{staticClass:"modal-card-body"},[a("b-field",{attrs:{label:"Type","label-position":"on-border"}},[a("b-select",{attrs:{placeholder:"Type"},model:{value:t.tempCost.type,callback:function(e){t.$set(t.tempCost,"type",e)},expression:"tempCost.type"}},[a("option",{attrs:{value:"payment"}},[t._v("Crédit (+)")]),a("option",{attrs:{value:"cost"}},[t._v("Débit (-)")]),a("option",{attrs:{value:"payment-bank"}},[t._v("Paiement via banque (+)")]),a("option",{attrs:{value:"payment-cash"}},[t._v("Paiement par liquide (+)")])])],1),a("b-field",{attrs:{label:"Label","label-position":"on-border"}},[a("b-input",{attrs:{placeholder:"Virement"},model:{value:t.tempCost.label,callback:function(e){t.$set(t.tempCost,"label",e)},expression:"tempCost.label"}})],1),a("b-field",{attrs:{label:"Unités","label-position":"on-border"}},[a("b-input",{model:{value:t.tempCost.units,callback:function(e){t.$set(t.tempCost,"units",e)},expression:"tempCost.units"}})],1),a("b-field",{attrs:{label:"Prix unitaire","label-position":"on-border"}},[a("b-input",{model:{value:t.tempCost.unitPrice,callback:function(e){t.$set(t.tempCost,"unitPrice",e)},expression:"tempCost.unitPrice"}})],1),a("b-field",{attrs:{label:"Total","label-position":"on-border"}},[a("b-numberinput",{attrs:{controls:!1,"icon-pack":"fas","controls-position":"compact",step:"0.01",placeholder:"450"},model:{value:t.tempCost.totalPrice,callback:function(e){t.$set(t.tempCost,"totalPrice",e)},expression:"tempCost.totalPrice"}})],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("b-button",{attrs:{disabled:0==this.canAddTransaction,type:"is-primary"},on:{click:function(e){return t.addCost()}}},[t._v("Ajouter")])],1)])]),a("hr"),a("label",{staticClass:"label"},[t._v("Coût interne")]),t._l(t.booking.internalCosts,(function(e){return a("div",{key:e.id,staticClass:"container",staticStyle:{"margin-bottom":"1rem"}},[a("article",{staticClass:"message is-light"},[a("div",{staticClass:"message-header"},[a("p",[a("b-icon",{staticStyle:{"margin-right":"0.5ch",display:"inline-table"},attrs:{pack:"fas",icon:"arrow-down",size:"is-medium",type:"is-grey"}}),t._v(" "+t._s(e.label)+" ")],1),a("span",{staticClass:"is-danger\n                  "},[t._v(" "+t._s(e.totalPrice)+" € ")]),a("div",{staticClass:"buttons"},[a("b-button",{attrs:{"icon-pack":"fas","icon-left":"pencil-alt",type:"is-dark"},on:{click:function(a){return t.editInternalCost(e)}}}),a("b-button",{attrs:{"icon-pack":"fas",type:" is-danger","icon-left":"trash"},on:{click:function(a){t.$delete(t.booking.internalCosts,t.booking.internalCosts.indexOf(e))}}})],1)])])])})),a("b-button",{on:{click:function(e){t.isInternalCostModalActive=!0}}},[t._v("Ajouter coût interne")]),a("b-modal",{attrs:{active:t.isInternalCostModalActive,"has-modal-card":"","destroy-on-hide":!1,width:"50%","trap-focus":"",scroll:"keep"},on:{"update:active":function(e){t.isInternalCostModalActive=e}}},[a("div",{staticClass:"modal-card"},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Ajouter coût interne")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){t.isInternalCostModalActive=!1}}})]),a("section",{staticClass:"modal-card-body"},[a("b-field",{attrs:{label:"Label","label-position":"on-border"}},[a("b-input",{attrs:{placeholder:"Ménage"},model:{value:t.tempInternalCost.label,callback:function(e){t.$set(t.tempInternalCost,"label",e)},expression:"tempInternalCost.label"}})],1),a("b-field",{attrs:{label:"Total","label-position":"on-border"}},[a("b-numberinput",{attrs:{controls:!1,"icon-pack":"fas","controls-position":"compact",step:"0.01",placeholder:"25"},model:{value:t.tempInternalCost.totalPrice,callback:function(e){t.$set(t.tempInternalCost,"totalPrice",e)},expression:"tempInternalCost.totalPrice"}})],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("b-button",{attrs:{disabled:!this.canAddInternalCost,type:"is-primary"},on:{click:function(e){return t.addInternalCost()}}},[t._v("Ajouter")])],1)])]),a("div",{staticClass:"block"}),a("br")],2)],2),t._m(1),a("div",{staticClass:"subsection"},[a("label",{staticClass:"label"},[t._v("Invoices")]),t._l(t.invoices,(function(e){return a("div",{key:e.meta.uuid,staticClass:"container",staticStyle:{"margin-bottom":"1rem"}},[a("article",{staticClass:"message is-dark"},[a("div",{staticClass:"message-header"},[a("p",[t._v(" "+t._s(e.main.status)+" - "+t._s(t.formatDate(e.meta.creationDate,"ddmmyyyy"))+" "),a("span",{staticClass:"has-text-grey"},[t._v(" - "+t._s(e.main.value)+" €")])]),a("div",[a("b-button",{attrs:{type:""},on:{click:function(a){return t.getInvoice(t.state,"save",e.meta.uuid)}}},[t._v(" REFRESH")]),a("b-button",{attrs:{type:""},on:{click:function(a){return t.viewInvoice(e)}}},[t._v(" VIEW")]),a("b-button",{attrs:{type:"is-warning"},on:{click:function(a){return t.getInvoice(t.state,"print",e.meta.uuid)}}},[t._v(" PRINT")])],1),a("button",{staticClass:"delete",on:{click:function(a){t.$delete(t.invoices,t.invoices.indexOf(e))}}})]),a("div",{staticClass:"message-body"},[a("div",{staticClass:"block"},[a("div",{staticClass:"field is-grouped is-grouped-multiline"},[a("div",{staticClass:"control"},[a("div",{staticClass:"tags has-addons"},[a("span",{staticClass:"tag is-dark is-small"},[t._v("Check-in")]),a("span",{staticClass:"tag is-light is-small"},[t._v(" "+t._s(t.formatDate(e.stay.arrivalDate,"human"))+" "),a("b-icon",{staticStyle:{"margin-left":"0.5ch","margin-right":"0.5ch"},attrs:{pack:"fas",icon:"clock",size:"is-small"}}),t._v(" "+t._s(t.humanFormatTime(e.stay.arrivalTime))+" ")],1)])]),a("div",{staticClass:"control"},[a("div",{staticClass:"tags has-addons"},[a("span",{staticClass:"tag is-dark is-small"},[t._v("Check-out")]),a("span",{staticClass:"tag is-light is-small"},[t._v(" "+t._s(t.formatDate(e.stay.departureDate,"human"))+" "),a("b-icon",{staticStyle:{"margin-left":"0.5ch","margin-right":"0.5ch"},attrs:{pack:"fas",icon:"clock",size:"is-small"}}),t._v(" "+t._s(t.humanFormatTime(e.stay.departureTime))+" ")],1)])]),a("div",{staticClass:"control"},[a("span",{staticClass:"tag is-dark is-small"},[t._v(t._s(e.stay.guestAmount.min)+"-"+t._s(e.stay.guestAmount.max)+" personnes")])])])]),a("table",{staticClass:"table is-fullwidth is-bordered"},[t._m(2,!0),a("tbody",[0!==e.stay.total?a("tr",[a("td",[t._v("Total sejour")]),a("td",[t._v(" "+t._s(e.stay.total)+" € ")])]):t._e(),0!==e.meals.total?a("tr",[a("td",[t._v("Total restauration")]),a("td",[t._v(t._s(e.meals.total)+" €")])]):t._e()]),t._l(e.main.costs,(function(e){return a("tbody",{key:e.id},[a("tr",[a("td",[t._v(" "+t._s(e.label)+" "),null!==e.units&null!==e.unitPrice?a("span",{staticClass:"has-text-grey",staticStyle:{"margin-left":"1rem"}},[t._v(t._s(e.units)+" x "+t._s(e.unitPrice)+" €")]):t._e()]),a("td",[t._v(t._s(e.totalPrice)+" €")])])])})),t._l(e.main.discounts,(function(e){return a("tbody",{key:e.id},[a("tr",{staticClass:"has-text-success has-text-weight-semibold"},[a("td",[t._v(" "+t._s(e.label)+" "),null!==e.units&null!==e.unitPrice?a("span",{staticClass:"has-text-grey",staticStyle:{"margin-left":"1rem"}},[t._v(t._s(e.units)+" x "+t._s(e.unitPrice)+" €")]):t._e()]),a("td",[t._v("-"+t._s(e.totalPrice)+" €")])])])})),a("tbody",[a("tr",{staticClass:"has-background-light"},[a("td",{staticClass:"has-text-darkgrey is-uppercase has-text-weight-semibold"},[t._v(" Sous-total ")]),a("td",{staticClass:"has-text-darkgrey is-uppercase has-text-weight-bold"},[t._v(" "+t._s(e.main.total)+" € ")])])]),t._l(e.main.transactions,(function(e){return a("tbody",{key:e.id},[a("tr",[a("td",{staticClass:"has-text-success has-text-weight-semibold\n                "},[t._v(" "+t._s(e.label)+" "),null!==e.units&null!==e.unitPrice?a("span",{staticClass:"has-text-grey",staticStyle:{"margin-left":"1rem"}},[t._v(t._s(e.units)+" x "+t._s(e.unitPrice)+" €")]):t._e()]),a("td",{staticClass:"has-text-success has-text-weight-semibold"},[t._v(" -"+t._s(e.totalPrice)+" € ")])])])})),a("tbody",[a("tr",{staticClass:"has-background-light"},[a("td",{staticClass:"has-text-darkgrey is-uppercase has-text-weight-semibold"},[t._v(" Reste à payer ")]),a("td",{staticClass:"has-text-darkgrey is-uppercase has-text-weight-semibold"},[t._v(" "+t._s(e.main.toPay)+" € ")])])])],2)])])])})),a("b-button",{on:{click:function(e){t.isNewInvoiceModalActive=!0}}},[t._v("Add Invoice")]),a("b-modal",{attrs:{active:t.isNewInvoiceModalActive,"has-modal-card":"","destroy-on-hide":!1,width:"50%","trap-focus":"",scroll:"keep"},on:{"update:active":function(e){t.isNewInvoiceModalActive=e}}},[a("div",{staticClass:"modal-card"},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Add invoice")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){t.isNewInvoiceModalActive=!1}}})]),a("section",{staticClass:"modal-card-body"},[a("div",{staticClass:"block"},[a("b-field",{attrs:{label:"Creation date","label-position":"on-border"}},[a("b-datepicker",{attrs:{"first-day-of-week":1,inline:"","icon-pack":"fas",placeholder:"Creation date"},model:{value:t.tempCreationDate,callback:function(e){t.tempCreationDate=e},expression:"tempCreationDate"}})],1)],1),a("b-field",[a("b-checkbox-button",{attrs:{type:"is-success"},model:{value:t.tempInvoice.meta.stayNoPrint,callback:function(e){t.$set(t.tempInvoice.meta,"stayNoPrint",e)},expression:"tempInvoice.meta.stayNoPrint"}},[a("b-icon",{attrs:{pack:"fas",icon:"bed",size:"is-small"}}),a("span",[t._v("Stay")])],1),a("b-checkbox-button",{attrs:{type:"is-success"},model:{value:t.tempInvoice.meta.cateringNoPrint,callback:function(e){t.$set(t.tempInvoice.meta,"cateringNoPrint",e)},expression:"tempInvoice.meta.cateringNoPrint"}},[a("b-icon",{attrs:{pack:"fas",icon:"utensils",size:"is-small"}}),a("span",[t._v("Catering")])],1),a("b-checkbox-button",{attrs:{type:"is-success"},model:{value:t.tempInvoice.meta.contractNoPrint,callback:function(e){t.$set(t.tempInvoice.meta,"contractNoPrint",e)},expression:"tempInvoice.meta.contractNoPrint"}},[a("b-icon",{attrs:{pack:"fas",icon:"file",size:"is-small"}}),a("span",[t._v("Contract")])],1)],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("div",{staticClass:"block"},[a("button",{staticClass:"button is-primary",on:{click:function(e){return t.getInvoice(t.state,"view")}}},[a("b-icon",{attrs:{pack:"fas",icon:"eye",size:"is-small"}}),a("span",[t._v("Check invoice")])],1),a("button",{staticClass:"button is-primary",on:{click:function(e){return t.getInvoice(t.state,"save")}}},[a("b-icon",{attrs:{pack:"fas",icon:"save",size:"is-small"}}),a("span",[t._v("New invoice")])],1)])])])]),a("div",{staticClass:"block"}),a("br")],2),a("b-modal",{staticStyle:{height:"100%"},attrs:{active:t.isInvoiceModalActive,"trap-focus":"",width:"50%"},on:{"update:active":function(e){t.isInvoiceModalActive=e}}},[a("htmlinvoice")],1)],1)])])},G=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-light"},[a("h5",{staticClass:"is-size-5 subtitle has-text-dark has-text-weight-medium"},[t._v(" Cautions & transactions ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-light"},[a("h5",{staticClass:"is-size-5 subtitle has-text-black has-text-weight-medium"},[t._v(" Edit invoice ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"has-background-light"},[a("th",[t._v("Produit")]),a("th",[t._v("Total")])])])}],W=(a("c740"),a("65ca")),X=(a("3e8f"),a("bc3a")),Q=a.n(X),Z={components:{htmlinvoice:W["a"]},data:function(){return{editMode:!1,isDepositModalActive:!1,isInvoiceModalActive:!1,isNewInvoiceModalActive:!1,currentInvoiceUuid:null,isTransactionModalActive:!1,isInternalCostModalActive:!1,booking:this.$store.state.booking,invoices:this.$store.state.invoices,state:this.$store.state,tempDeposit:{id:null,status:null,type:null,amount:null,dateReceived:null},tempCost:{id:null,type:null,label:null,units:null,unitPrice:null,totalPrice:null},tempInternalCost:{id:null,label:null,totalPrice:null},tempInvoice:{meta:{uuid:null,lastModificationDate:null,creationDate:null,cateringNoPrint:!this.$store.state.settings.invoiceData.print.catering,stayNoPrint:!this.$store.state.settings.invoiceData.print.stay,contractNoPrint:!this.$store.state.settings.invoiceData.print.contract,invoiceNumber:this.$store.state.booking.invoiceNumber}},tempCreationDate:w()().toDate()}},computed:{canAddDeposit:function(){return!(this.isEmpty(this.tempDeposit.status)|this.isEmpty(this.tempDeposit.type)|this.isEmpty(this.tempDeposit.amount))},canAddTransaction:function(){return!(this.isEmpty(this.tempCost.type)|this.isEmpty(this.tempCost.label)|isNaN(this.tempCost.totalPrice)|this.isEmpty(this.tempCost.totalPrice))},canAddInternalCost:function(){return!(this.isEmpty(this.tempInternalCost.label)|isNaN(this.tempInternalCost.totalPrice)|this.isEmpty(this.tempInternalCost.totalPrice))}},watch:{},mounted:function(){},methods:{isEmpty:function(t){return!!(null===t|""===t)},formatDate:function(t,e){return"human"==e?w()(t).format("ddd D MMM YYYY"):"ddmmyyyy"==e?w.a.unix(t).format("DD/MM/YYYY"):void 0},humanFormatTime:function(t){return w()(t).format("HH:mm")},uuidv4:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,a="x"==t?e:3&e|8;return a.toString(16)}))},openModal:function(){this.$buefy.modal.open({parent:this,component:htmlInvoice,hasModalCard:!1})},addDeposit:function(){var t=this.tempDeposit,e=this.booking.deposits;e.find((function(e){return e.id===t.id}))?s["a"]["delete"](this.booking.deposits,this.booking.deposits.findIndex((function(e){return e.id==t.id}))):t.id=this.uuidv4(),e.push(t),s["a"].set(this.booking,"deposits",JSON.parse(JSON.stringify(e))),this.isDepositModalActive=!1,this.tempDeposit={id:null,status:null,type:null,amount:null,dateReceived:null}},editDeposit:function(t){var e=JSON.parse(JSON.stringify(t));e.dateReceived&&(e.dateReceived=w()(t.dateReceived).toDate()),this.tempDeposit=e,this.isDepositModalActive=!0},getInvoice:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e,a,i){var s,n,r,o,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s={"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},n=this.tempCreationDate,r=e,o=JSON.parse(JSON.stringify(this.tempInvoice)),l=r.invoices,i?(o.meta.uuid=i,o=l.find((function(t){return t.meta.uuid===i}))):(o.meta.creationDate=w()(n).unix(),o.meta.lastModificationDate=w()(n).unix()),"print"!=a){t.next=10;break}return localStorage.setItem("tempInvoice",JSON.stringify(o)),this.printInvoice(),t.abrupt("return",0);case 10:return c={},c["action"]="get-invoice",c["data"]=r,c["invoice"]=o,t.next=16,Q()({method:"post",url:"/api",headers:s,data:c}).then((function(t){return t.data}))["catch"]((function(t){console.log(t)}));case 16:return u=t.sent,"save"==a&&(this.$store.commit("updateInvoice",u),this.isNewInvoiceModalActive=!1),localStorage.setItem("tempInvoice",JSON.stringify(u)),"view"==a&&(this.isInvoiceModalActive=!0),this.$forceUpdate(),t.abrupt("return",u);case 22:case"end":return t.stop()}}),t,this)})));function e(e,a,i){return t.apply(this,arguments)}return e}(),viewInvoice:function(t){localStorage.setItem("tempInvoice",JSON.stringify(t)),this.isInvoiceModalActive=!0,this.$forceUpdate()},printInvoice:function(){var t=window.open("/htmlinvoice");t.focus(),t.print()},addCost:function(){var t=this.tempCost,e=this.booking.costs;e.find((function(e){return e.id===t.id}))?s["a"]["delete"](this.booking.costs,this.booking.costs.findIndex((function(e){return e.id==t.id}))):t.id=this.uuidv4(),e.push(t),this.isTransactionModalActive=!1,s["a"].set(this.booking,"costs",JSON.parse(JSON.stringify(e))),this.tempCost={id:null,type:null,label:null,units:null,unitPrice:null,totalPrice:null}},editCost:function(t){var e=JSON.parse(JSON.stringify(t));this.tempCost=e,this.editMode=!0,this.isTransactionModalActive=!0},addInternalCost:function(){var t=this.tempInternalCost,e=this.booking.internalCosts;e.find((function(e){return e.id===t.id}))?s["a"]["delete"](this.booking.internalCosts,this.booking.internalCosts.findIndex((function(e){return e.id==t.id}))):t.id=this.uuidv4(),e.push(t),this.isInternalCostModalActive=!1,s["a"].set(this.booking,"internalCosts",JSON.parse(JSON.stringify(e))),this.tempInternalCost={id:null,label:null,totalPrice:null}},editInternalCost:function(t){var e=JSON.parse(JSON.stringify(t));this.tempInternalCost=e,this.isInternalCostModalActive=!0},getDepositIcon:function(t){return"cheque"===t?"money-check-alt":"cash"===t?"money-bill-wave":"transfer"===t?"exchange-alt":"money-check-alt"}}},tt=Z,et=Object(c["a"])(tt,K,G,!1,null,"ed464e20",null),at=et.exports,it=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"section",staticStyle:{height:"100%"}},[a("div",{staticClass:"container"},[t._m(0),a("div",{staticClass:"box has-background-light"},[a("div",{staticClass:"columns"},[a("setting-sheet")],1)])])])},st=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("h3",{staticClass:"title is-3"},[t._v("Settings")])])}],nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column"},[a("div",{staticClass:"box"},[a("div",{staticClass:"level"},[a("div",{staticClass:"level-left"},[a("b-dropdown",{attrs:{"aria-role":"list"}},[a("button",{staticClass:"button is-primary",attrs:{slot:"trigger"},slot:"trigger"},[a("span",[t._v(t._s(t.currentSettings.name))]),a("b-icon",{attrs:{pack:"fas",icon:"caret-down"}})],1),t._l(t.fileSettings,(function(e){return a("div",{key:e.name},[a("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(a){return t.setSetting(e.name)}}},[t._v(t._s(e.name)+" "),e.default?a("div",{staticClass:"tag is-warning",staticStyle:{"margin-left":"1rem"}},[t._v(" DEFAULT ")]):t._e()])],1)}))],2)],1),a("div",{staticClass:"level-right"},[a("b-button",{staticClass:"has-text-weight-medium is-uppercase level-item",attrs:{type:"is-dark"},on:{click:function(e){t.editingCurrent=!t.editingCurrent}}},[t._v(" "+t._s(t.editingCurrent?"LOCK":"UNLOCK")+" ")]),t.currentSettings.default?t._e():a("b-button",{staticClass:"has-text-weight-medium is-uppercase level-item",attrs:{type:"is-warning"},on:{click:function(e){return t.saveSettings(t.currentSettings,"modify-setting")}}},[t._v(" "+t._s(t.currentSettings.default?"DEFAULT":" SET DEFAULT")+" ")]),t.currentSettings.default?t._e():a("b-button",{staticClass:"has-text-weight-medium is-uppercase level-item",attrs:{type:"is-danger"},on:{click:function(e){return t.saveSettings(t.currentSettings,"delete-setting")}}},[t._v(" DELETE ")]),a("b-button",{attrs:{disabled:t.notUpdatable,type:"is-success"},on:{click:function(e){t.isSaveModalActive=!0}}},[t._v(t._s(t.fileSettings.some((function(e){return e.name===t.currentSettings.name}))?"Update ":"New ")+" settings")]),a("b-modal",{attrs:{active:t.isSaveModalActive,"has-modal-card":"","destroy-on-hide":!1,width:"50%","trap-focus":"",scroll:"keep"},on:{"update:active":function(e){t.isSaveModalActive=e}}},[a("div",{staticClass:"modal-card"},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Save new profile")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){t.isSaveModalActive=!1}}})]),a("section",{staticClass:"modal-card-body"},[a("b-field",{attrs:{label:"Name","label-position":"on-border"}},[a("b-input",{attrs:{placeholder:"default"},model:{value:t.currentSettings.name,callback:function(e){t.$set(t.currentSettings,"name",e)},expression:"currentSettings.name"}})],1),a("div",{staticClass:"block"},[t.nameExists?a("span",{staticClass:"has-text-danger has-text-weight-bold"},[t._v("THIS WILL OVERWRITE "+t._s(t.currentSettings.name))]):t._e()])],1),a("footer",{staticClass:"modal-card-foot"},[a("b-button",{attrs:{type:"is-primary"},on:{click:function(e){return t.saveSettings(t.currentSettings,"save-setting")}}},[t._v("Ajouter")])],1)])])],1)]),t._m(0),a("div",{staticClass:"subsection"},[a("b-field",{attrs:{grouped:"","grouped-muliline":""}},[a("b-field",{attrs:{label:"Villa night"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",controls:!1,min:"0",step:.01,type:"is-light",disabled:!t.editingCurrent},model:{value:t.currentSettings.prices.villa,callback:function(e){t.$set(t.currentSettings.prices,"villa",e)},expression:"currentSettings.prices.villa"}})],1),a("b-field",{attrs:{label:"Guest night"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",controls:!1,min:"0",step:.01,type:"is-light",disabled:!t.editingCurrent},model:{value:t.currentSettings.prices.guest,callback:function(e){t.$set(t.currentSettings.prices,"guest",e)},expression:"currentSettings.prices.guest"}})],1),a("b-field",{attrs:{label:"Pet night"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",controls:!1,min:"0",step:.01,type:"is-light",disabled:!t.editingCurrent},model:{value:t.currentSettings.prices.pet,callback:function(e){t.$set(t.currentSettings.prices,"pet",e)},expression:"currentSettings.prices.pet"}})],1),a("b-field",{attrs:{label:"Extra hour"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",controls:!1,min:"0",step:.01,type:"is-light",disabled:!t.editingCurrent},model:{value:t.currentSettings.prices.extraHour,callback:function(e){t.$set(t.currentSettings.prices,"extraHour",e)},expression:"currentSettings.prices.extraHour"}})],1),a("b-field",{attrs:{label:"Taxe de Sejour (%)"}},[a("b-numberinput",{attrs:{"icon-pack":"fas",controls:!1,min:"0",type:"is-light",step:.001,disabled:!t.editingCurrent},model:{value:t.currentSettings.prices.taxeSejour,callback:function(e){t.$set(t.currentSettings.prices,"taxeSejour",e)},expression:"currentSettings.prices.taxeSejour"}})],1)],1),a("hr"),t._m(1),a("b-field",{attrs:{grouped:"","group-multiline":""}},t._l(t.currentSettings.discountPerNight,(function(e,i){return a("b-field",{key:i,attrs:{label:i+" nights"}},[a("b-numberinput",{staticStyle:{"max-width":"100px"},attrs:{"icon-pack":"fas",min:"0",type:"is-light",step:.01,controls:!1,disabled:!t.editingCurrent},model:{value:t.currentSettings.discountPerNight[i],callback:function(e){t.$set(t.currentSettings.discountPerNight,i,e)},expression:"currentSettings.discountPerNight[nights]"}})],1)})),1),a("hr"),t._m(2),a("b-field",{attrs:{grouped:"","grouped-multiline":""}},[a("b-field",{attrs:{label:"Check-in"}},[a("b-field",{attrs:{grouped:""}},[a("b-numberinput",{staticStyle:{"max-width":"100px"},attrs:{"icon-pack":"fas",min:"0",type:"is-light",step:.01,controls:!1,disabled:!t.editingCurrent},model:{value:t.currentSettings.minArrivalTime.hour,callback:function(e){t.$set(t.currentSettings.minArrivalTime,"hour",e)},expression:"currentSettings.minArrivalTime.hour"}}),a("span",{staticClass:"is-size-4"},[t._v(":")]),a("b-numberinput",{staticStyle:{"max-width":"100px"},attrs:{"icon-pack":"fas",min:"0",type:"is-light",step:.01,controls:!1,disabled:!t.editingCurrent},model:{value:t.currentSettings.minArrivalTime.minute,callback:function(e){t.$set(t.currentSettings.minArrivalTime,"minute",e)},expression:"currentSettings.minArrivalTime.minute"}})],1)],1),a("b-field",{attrs:{label:"Check-out"}},[a("b-field",{attrs:{grouped:""}},[a("b-numberinput",{staticStyle:{"max-width":"100px"},attrs:{"icon-pack":"fas",min:"0",type:"is-light",controls:!1,disabled:!t.editingCurrent},model:{value:t.currentSettings.maxDepartureTime.hour,callback:function(e){t.$set(t.currentSettings.maxDepartureTime,"hour",e)},expression:"currentSettings.maxDepartureTime.hour"}}),a("span",{staticClass:"is-size-4"},[t._v(":")]),a("b-numberinput",{staticStyle:{"max-width":"100px"},attrs:{"icon-pack":"fas",min:"0",type:"is-light",controls:!1,disabled:!t.editingCurrent},model:{value:t.currentSettings.maxDepartureTime.minute,callback:function(e){t.$set(t.currentSettings.maxDepartureTime,"minute",e)},expression:"currentSettings.maxDepartureTime.minute"}})],1)],1)],1),a("hr"),t._m(3),a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("b-field",{attrs:{label:"Footer main invoice page"}},[a("b-input",{attrs:{type:"textarea",disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.mainTableFooter,callback:function(e){t.$set(t.currentSettings.invoiceData,"mainTableFooter",e)},expression:"currentSettings.invoiceData.mainTableFooter"}})],1)],1),a("div",{staticClass:"column"},[a("b-field",{attrs:{label:"Footer main invoice table"}},[a("b-input",{attrs:{type:"textarea",disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.mainPageFooter,callback:function(e){t.$set(t.currentSettings.invoiceData,"mainPageFooter",e)},expression:"currentSettings.invoiceData.mainPageFooter"}})],1)],1)]),a("hr"),a("b-field",{attrs:{label:"Host information"}}),a("b-field",{attrs:{grouped:"","group-multiline":""}},[a("b-field",{attrs:{label:"Name","label-position":"on-border"}},[a("b-input",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.host.name,callback:function(e){t.$set(t.currentSettings.invoiceData.host,"name",e)},expression:"currentSettings.invoiceData.host.name"}})],1),a("b-field",{attrs:{label:"Phone","label-position":"on-border"}},[a("b-input",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.host.phone,callback:function(e){t.$set(t.currentSettings.invoiceData.host,"phone",e)},expression:"currentSettings.invoiceData.host.phone"}})],1),a("b-field",{attrs:{label:"Email","label-position":"on-border"}},[a("b-input",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.host.email,callback:function(e){t.$set(t.currentSettings.invoiceData.host,"email",e)},expression:"currentSettings.invoiceData.host.email"}})],1),a("b-field",{attrs:{label:"Address line 1","label-position":"on-border"}},[a("b-input",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.host.address1,callback:function(e){t.$set(t.currentSettings.invoiceData.host,"address1",e)},expression:"currentSettings.invoiceData.host.address1"}})],1),a("b-field",{attrs:{label:"Address line 2","label-position":"on-border"}},[a("b-input",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.host.address2,callback:function(e){t.$set(t.currentSettings.invoiceData.host,"address2",e)},expression:"currentSettings.invoiceData.host.address2"}})],1)],1),a("hr"),a("b-field",{attrs:{label:"Property information"}}),a("b-field",{attrs:{grouped:"","group-multiline":""}},[a("b-field",{attrs:{label:"Description","label-position":"on-border"}},[a("b-input",{attrs:{disabled:!t.editingCurrent,type:"textarea"},model:{value:t.currentSettings.invoiceData.property.description,callback:function(e){t.$set(t.currentSettings.invoiceData.property,"description",e)},expression:"currentSettings.invoiceData.property.description"}})],1),a("b-field",{attrs:{label:"Address","label-position":"on-border"}},[a("b-input",{attrs:{disabled:!t.editingCurrent,type:"textarea"},model:{value:t.currentSettings.invoiceData.property.address,callback:function(e){t.$set(t.currentSettings.invoiceData.property,"address",e)},expression:"currentSettings.invoiceData.property.address"}})],1)],1),a("hr"),a("b-field",{attrs:{label:"Print on invoice :"}}),a("div",{staticClass:"field"},[a("b-checkbox",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.print.catering,callback:function(e){t.$set(t.currentSettings.invoiceData.print,"catering",e)},expression:"currentSettings.invoiceData.print.catering"}},[t._v(" Catering ")]),a("div",{staticClass:"field"}),a("b-checkbox",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.print.contract,callback:function(e){t.$set(t.currentSettings.invoiceData.print,"contract",e)},expression:"currentSettings.invoiceData.print.contract"}},[t._v(" Contract ")]),a("div",{staticClass:"field"}),a("b-checkbox",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.print.stay,callback:function(e){t.$set(t.currentSettings.invoiceData.print,"stay",e)},expression:"currentSettings.invoiceData.print.stay"}},[t._v(" Stay ")])],1),a("hr"),a("b-field",{attrs:{label:"Invoice made in"}},[a("b-input",{attrs:{disabled:!t.editingCurrent},model:{value:t.currentSettings.invoiceData.creationCity,callback:function(e){t.$set(t.currentSettings.invoiceData,"creationCity",e)},expression:"currentSettings.invoiceData.creationCity"}})],1),a("div",{staticClass:"container"})],1)])])},rt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-dark"},[a("h5",{staticClass:"is-size-5 subtitle has-text-light has-text-weight-medium"},[t._v(" Prices ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-dark"},[a("h5",{staticClass:"is-size-5 subtitle has-text-light has-text-weight-medium"},[t._v(" Discount per night ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-dark"},[a("h5",{staticClass:"is-size-5 subtitle has-text-light has-text-weight-medium"},[t._v(" Check-in / Check-out ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"subsection-header has-background-dark"},[a("h5",{staticClass:"is-size-5 subtitle has-text-light has-text-weight-medium"},[t._v(" Invoice information ")])])}],ot=(a("45fc"),a("cf9c")),lt=a("f654"),ct=a.n(lt),ut={data:function(){return{editingCurrent:!1,fileSettings:ot,isSaveModalActive:!1}},computed:{currentSettings:function(){return this.$store.state.settings},nameExists:function(){var t=this;return this.fileSettings.some((function(e){return e.name===t.currentSettings.name}))},notUpdatable:function(){var t=this,e=this.fileSettings.find((function(e){return e.name===t.currentSettings.name}));e=e;var a=this.currentSettings,i=this.deepEqual(e,a);return i}},methods:{deepEqual:function(t,e){try{ct.a.deepEqual(t,e)}catch(a){if("AssertionError"===a.name)return!1;throw a}return!0},setSetting:function(t){var e=JSON.parse(JSON.stringify(this.fileSettings));s["a"].set(this.$store.state,"settings",e.find((function(e){return e.name===t})))},saveSettings:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e,a){var i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},s={},s["action"]=a,s["data"]=e,t.next=6,Q()({method:"post",url:"/api",headers:i,data:s}).then((function(t){return t.data}))["catch"]((function(t){console.log(t)}));case 6:return n=t.sent,this.$forceUpdate(),this.setSetting(e.name),t.abrupt("return",n);case 10:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()}},dt=ut,pt=Object(c["a"])(dt,nt,rt,!1,null,"0f015b59",null),mt=pt.exports,bt={components:{settingSheet:mt},data:function(){return{tempInvoice:{meta:{uuid:null,lastModificationDate:null,creationDate:null,cateringNoPrint:!1,stayNoPrint:!1,contractNoPrint:!1,invoiceNumber:this.$store.state.booking.invoiceNumber}}}},computed:{},watch:{},mounted:function(){},methods:{}},ht=bt,vt=(a("3b43"),Object(c["a"])(ht,it,st,!1,null,"04b9e6e5",null)),ft=vt.exports,gt=a("2978"),yt=a("c0ab"),xt=new yt(gt),kt={components:{reservationTab:V,cateringTab:H,invoiceTab:at,settingsTab:ft},beforeMount:function(){var t=this;window.addEventListener("beforeunload",(function(e){t.synced||(e.preventDefault(),e.returnValue="")}))},data:function(){return{activeTab:0,apiStateNeedsUpdate:!0,synced:!1,justLoaded:!0,updateTab:!1,devIsTrue:!1,isStoreModalActive:!1}},computed:{state:function(){return this.$store.state},dataReady:function(){var t=this.state;return!!(null!==t.booking.status&t.stay.arrivalDate!=t.stay.departureDate)}},mounted:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this.$route.params.uuid,void 0!==e&&(this.state.booking.uuid=e,this.getApi(this.state,"retrieve")),localStorage.setItem("state",this.state);case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),asyncComputed:{apiState:{get:function(){var t=this.getApi(this.state,"update");return this.apiStateNeedsUpdate=!1,t},default:function(){return this.state},shouldUpdate:function(){return this.apiStateNeedsUpdate}}},watch:{state:{handler:function(){this.state!=this.apiState&&(this.apiStateNeedsUpdate=!0),localStorage.setItem("state",JSON.stringify(this.state))},deep:!0}},methods:{listEvents:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e,a){var i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={q:a,singleEvents:!0,orderBy:"startTime"},t.next=3,xt.Events.list(e,i);case 3:return s=t.sent,n=[],s.forEach((function(t){t.calendarId=e,t.description.includes(a)&&n.push(t)})),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));function e(e,a){return t.apply(this,arguments)}return e}(),concatEvents:function(t){var e=[];return t.forEach((function(t){return e=e.concat(t)})),e},getEvent:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e){var a,i,s,n,r,o,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=[],i=0,s=Object.entries(gt.calendarIdList);case 2:if(!(i<s.length)){t.next=12;break}return n=Object(b["a"])(s[i],2),n[0],r=n[1],t.t0=a,t.next=7,this.listEvents(r,e);case 7:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 9:i++,t.next=2;break;case 12:return o=Promise.all(a).then((function(t){return l.concatEvents(a)})),t.abrupt("return",o);case 14:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),upsertEvent:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e){var a,i,s,n,r,o,l,c,u,d,p,m,b,h,v=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.devIsTrue){t.next=3;break}return this.$buefy.toast.open({message:"Booking not changed in calendar",type:"is-danger",duration:5e3}),t.abrupt("return",null);case 3:if(a=w.a.unix(e.stay.arrivalTime),i=w.a.unix(e.stay.departureTime),s=w.a.unix(e.stay.arrivalDate).hour(a.hour()).minute(a.minute()),n=w.a.unix(e.stay.departureDate).hour(i.hour()).minute(i.minute()),n=n.subtract(1,"days"),s.clone().format("DD-MM-YYYY")==n.clone().format("DD-MM-YYYY")&&(n=s.clone(),n=n.add(1,"hours")),r=Math.max.apply(Math,e.stay.stayNightArray.map((function(t){return t.internal.kids+t.external.kids}))),o=Math.max.apply(Math,e.stay.stayNightArray.map((function(t){return t.internal.adults+t.external.adults}))),l=Math.max.apply(Math,e.stay.stayNightArray.map((function(t){return t.internal.pets+t.external.pets}))),c=Math.max.apply(Math,e.stay.stayNightArray.map((function(t){return t.internal.adults+t.external.adults+t.internal.kids+t.external.kids}))),u={start:{dateTime:s.toDate()},end:{dateTime:n.toDate()},summary:e.contact.name+", "+c+"p. "+e.stay.stayNightArray.length+"n. via "+e.booking.source,description:"http://localhost:8080/booking/"+e.booking.uuid+"\n\n"+o+" adults, "+r+" children, "+l+" pets\nCheck-out : "+n.format("HH:mm")+"\n\n"+e.stay.guestInfo+"\n\n"+e.meals.length+" meals\n\n"+e.contact.name+"\n"+e.contact.phone+"\n"+e.contact.email},d=e.booking.status,null!==d){t.next=18;break}return console.log("No status given, can't update calendar"),t.abrupt("return",1);case 18:if(p="cancelled"===d?gt.calendarIdList.cancelled:"inquiry"===d?gt.calendarIdList.inquiry:gt.calendarIdList.definitive,m=e.booking.uuid,null!==m){t.next=24;break}console.log("uuid is null"),t.next=28;break;case 24:return t.next=26,this.getEvent(m);case 26:b=t.sent,1===b.length?(h=b[0],xt.Events.update(h.calendarId,h.id,u).then((function(t){return h.calendarId!==p?xt.Events["delete"](h.calendarId,h.id).then((function(t){xt.Events.insert(p,u).then((function(t){v.$buefy.toast.open({message:"Booking updated and moved",type:"is-light",duration:5e3})}))["catch"]((function(t){console.log("Error: insertEvent "+t.message)}))}))["catch"]((function(t){console.log("Error deleteEvent:"+JSON.stringify(t.message))})):v.$buefy.toast.open({message:"Booking updated",type:"is-light",duration:5e3}),t}))["catch"]((function(t){console.log("Error: updatedEvent",t.message)}))):0===b.length&&xt.Events.insert(p,u).then((function(t){v.$buefy.toast.open({message:"Added new booking in calendar",type:"is-success",duration:5e3})}))["catch"]((function(t){console.log("Error: insertEvent "+t.message)}));case 28:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getApi:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e,a){var i,s,n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},s=e,n={},n["action"]=a,n["data"]=s,r=this.synced,t.next=8,Q()({method:"post",url:"/api",headers:i,data:n}).then((function(t){return r=t.data.synced,t.data.data}))["catch"]((function(t){console.log(t)}));case 8:return o=t.sent,null===e.booking.uuid&&this.$store.commit("addUUID",o.booking.uuid),this.synced=r,"save"===a&&(this.upsertEvent(o),this.$router.push("/booking/".concat(o.booking.uuid))["catch"]((function(t){}))),"retrieve"===a&&(this.$store.commit("replaceState",o),this.updateTab=!0),t.abrupt("return",o);case 14:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()}},Ct=kt,_t=(a("c4e7"),Object(c["a"])(Ct,p,m,!1,null,null,null)),Dt=_t.exports,St=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-navbar",{staticClass:"is-dark",attrs:{"fixed-top":""}},[i("template",{slot:"brand"},[i("b-navbar-item",{attrs:{href:"/"}},[i("img",{attrs:{src:a("5f60")}}),i("span",{staticClass:"navbar-item has-text-light"},[t._v("Moulin du Merle stay-manager")])])],1),i("template",{slot:"start"}),i("template",{slot:"end"},[i("b-navbar-item",{attrs:{tag:"div"}},[i("div",{staticClass:"buttons"},[i("b-button",{staticClass:"is-light",attrs:{tag:"router-link",to:"./booking",type:"is-link"}},[t._v("New Booking")])],1)])],1)],2),i("section",{staticClass:"app-section"},[i("div",{staticClass:"container reservation-list"},[i("div",{staticClass:"box"},[i("h3",{staticClass:"title is-3"},[t._v("Reservation list")]),i("b-field",{attrs:{grouped:""}},[i("p",{staticClass:"control"},[i("b-button",{attrs:{type:"is-dark",outlined:"",rounded:""},on:{click:function(e){return t.setDateFilter("year")}}},[t._v(t._s(t.thisYear))])],1),i("p",{staticClass:"control"},[i("b-button",{attrs:{type:"is-dark",outlined:"",rounded:""},on:{click:function(e){return t.setDateFilter("previous-year")}}},[t._v(t._s(t.thisYear-1))])],1),i("p",{staticClass:"control"},[i("b-button",{attrs:{type:"is-dark",outlined:"",rounded:""},on:{click:function(e){return t.setDateFilter("month")}}},[t._v(t._s(t.thisMonth))])],1),i("p",{staticClass:"control"},[i("b-button",{attrs:{type:"is-dark",outlined:"",rounded:""},on:{click:function(e){return t.setDateFilter("previous-month")}}},[t._v(t._s(t.thisMonth)+" "+t._s(t.thisYear-1))])],1),i("p",{staticClass:"control"},[i("b-button",{attrs:{type:"is-dark",outlined:"",rounded:""},on:{click:function(e){return t.setDateFilter("all")}}},[t._v("All")])],1),i("b-datepicker",{attrs:{"icon-pack":"fas",placeholder:"Click to select...","first-day-of-week":1,range:""},model:{value:t.filterDates,callback:function(e){t.filterDates=e},expression:"filterDates"}})],1),i("b-field",[i("b-checkbox-button",{attrs:{"native-value":"cancelled",type:"is-dark",outlined:""},model:{value:t.selectedTypes,callback:function(e){t.selectedTypes=e},expression:"selectedTypes"}},[t._v("Cancelled")]),i("b-checkbox-button",{attrs:{"native-value":"inquiry",type:"is-warning"},model:{value:t.selectedTypes,callback:function(e){t.selectedTypes=e},expression:"selectedTypes"}},[t._v("Inquiry")]),i("b-checkbox-button",{attrs:{"native-value":"contract",type:"is-success"},model:{value:t.selectedTypes,callback:function(e){t.selectedTypes=e},expression:"selectedTypes"}},[t._v("Contract")]),i("b-checkbox-button",{attrs:{"native-value":"completed",type:"is-success"},model:{value:t.selectedTypes,callback:function(e){t.selectedTypes=e},expression:"selectedTypes"}},[t._v("Completed")])],1),t.bookingList.length>0?i("div",{staticClass:"columns"},[i("div",{staticClass:"column"},[i("article",{staticClass:"message is-dark"},[i("div",{staticClass:"message-body is-size-6"},[i("p",{staticClass:"is-size-5"},[t._v(" Filter "),i("span",{staticClass:"has-text-weight-semibold"},[t._v("("+t._s(t.filterStats.total.number)+")")])]),i("p",[t._v(" Weeks : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterDateSpan))])]),i("p",[t._v(" Total : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.total.totalPaid)+" €")])]),i("p",[t._v(" Total Value : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.total.totalValue)+" €")])]),i("p",[t._v(" Total Tax : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.total.tax)+" € ("+t._s(t.filterStats.total.taxNights)+" nights)")])])])])]),i("div",{staticClass:"column"},[i("article",{staticClass:"message is-success"},[i("div",{staticClass:"message-body is-size-6"},[i("p",{staticClass:"is-size-5"},[t._v(" Completed "),i("span",{staticClass:"has-text-weight-semibold"},[t._v("("+t._s(t.filterStats.completed.number)+")")])]),i("p",[t._v(" Total : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.completed.totalPaid)+" €")])]),i("p",[t._v(" Value : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.completed.totalValue)+" €")])]),i("p",[t._v(" Average : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.completed.averageValue)+" €")])])])])]),i("div",{staticClass:"column"},[i("article",{staticClass:"message is-success"},[i("div",{staticClass:"message-body is-size-6"},[i("p",{staticClass:"is-size-5"},[t._v(" Contract "),i("span",{staticClass:"has-text-weight-semibold"},[t._v("("+t._s(t.filterStats.contract.number)+")")])]),i("p",[t._v(" Total : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.contract.totalPaid)+" €")])]),i("p",[t._v(" Value : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.contract.totalValue)+" €")])]),i("p",[t._v(" Average : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.contract.averageValue)+" €")])])])])]),i("div",{staticClass:"column"},[i("article",{staticClass:"message is-warning"},[i("div",{staticClass:"message-body is-size-6"},[i("p",{staticClass:"is-size-5"},[t._v(" Inquiry "),i("span",{staticClass:"has-text-weight-semibold"},[t._v("("+t._s(t.filterStats.inquiry.number)+")")])]),i("p",[t._v(" Total : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.inquiry.totalPaid)+" €")])]),i("p",[t._v(" Value : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.inquiry.totalValue)+" €")])]),i("p",[t._v(" Average : "),i("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.filterStats.inquiry.averageValue)+" €")])])])])])]):t._e(),t.bookingList.length>0?i("div",{staticClass:"card"},[i("div",{staticClass:"card-content"},[i("div",{staticClass:"content"},[[i("Bar",{attrs:{"chart-options":t.chartOptions,"chart-id":t.chartId,"dataset-id-key":t.datasetIdKey,plugins:t.plugins,"css-classes":t.cssClasses,styles:t.styles,width:t.width,height:t.height,"chart-data":t.filterStats.chartData}})],i("calendar-heatmap",{attrs:{"end-date":"2022-12-31",values:[{date:"2022-02-12",count:6},{date:"2022-12-12",count:6}]}}),[i("div",[i("VueApexCharts",{attrs:{height:"200",type:"heatmap",options:t.chartOptions2,series:t.series}})],1)]],2)])]):t._e(),i("table",{staticClass:"table is-fullwidth is-bordered"},[t._m(0),t._l(t.filteredBookingList,(function(e){return i("tbody",{key:e.uuid},[-1!=t.selectedTypes.indexOf(e.status)?i("tr",[i("td",[t._v(t._s(e.invoiceNumber))]),i("td",[i("b-button",{class:t.getStatusColor(e.status),attrs:{tag:"router-link",to:"/booking/"+e.uuid,type:"is-link"}},[t._v(t._s(e.status))])],1),i("td",[i("a",{staticClass:"has-text-link has-text-weight-bold",attrs:{href:"/booking/"+e.uuid}},[t._v(t._s(e.name))])]),i("td",[i("p",[t._v(" "+t._s(t.humanFormatDate(e.arrivalDate))+" ")]),i("p",[t._v(" "+t._s(t.humanFormatTime(e.arrivalTime))+" ")])]),i("td",[t._v(t._s(e.nights))]),e.minGuests==e.maxGuests?i("td",[t._v(" "+t._s(e.minGuests)+" ")]):t._e(),e.minGuests!=e.maxGuests?i("td",[t._v(" "+t._s(e.minGuests)+"-"+t._s(e.maxGuests)+" ")]):t._e(),i("td",[t._v(t._s(e.source))]),i("td",[t._v(t._s(e.meals))]),i("td",[i("p",[t._v(" "+t._s(e.paid)+" / "+t._s(e.total)+" ("+t._s(e.value)+") € ")]),i("p",[t._v(t._s(e.tax)+" € tax")])]),i("td",[i("b-field",[i("b-rate",{attrs:{"icon-pack":"fas",disabled:""},model:{value:e.rating,callback:function(a){t.$set(e,"rating",a)},expression:"booking.rating"}})],1)],1)]):t._e()])}))],2)],1)])])],1)},At=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"has-background-light"},[a("th",[t._v("No.")]),a("th",[t._v("Status")]),a("th",[t._v("Nom")]),a("th",[t._v("Check-in")]),a("th",[t._v("Nuits")]),a("th",[t._v("Clients")]),a("th",[t._v("Source")]),a("th",[t._v("Repas")]),a("th",[t._v("Valeur")]),a("th",[t._v("Avis")])])])}],wt=a("ade3"),Tt=(a("a9e3"),a("cb29"),a("26e9"),a("c975"),a("4de4"),a("13d5"),a("7b97")),Nt=a("9b4a"),It=a("1321"),Pt=a.n(It),$t=a("6b6d"),Et=a("2978"),Mt=a("c0ab"),Ot=new Mt(Et);Nt["e"].register(Nt["n"],Nt["o"],Nt["g"],Nt["b"],Nt["d"],Nt["i"]);var jt={components:{Bar:Tt["a"],VueApexCharts:Pt.a,CalendarHeatmap:$t["CalendarHeatmap"]},props:{chartId:{type:String,default:"bar-chart"},datasetIdKey:{type:String,default:"label"},width:{type:Number,default:400},height:{type:Number,default:100},cssClasses:{default:"",type:String},styles:{type:Object,default:function(){}},plugins:{type:Object,default:function(){}}},data:function(){var t;return{chartOptions2:{chart:{id:"vuechart-example"},xaxis:{categories:[2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,3,1]}},chartOptions:(t={responsive:!0,plugins:{title:{display:!0,text:"Revenue"}}},Object(wt["a"])(t,"responsive",!0),Object(wt["a"])(t,"interaction",{intersect:!1}),Object(wt["a"])(t,"scales",{x:{stacked:!0},y:{stacked:!0}}),t),filterDates:[w()().startOf("year").toDate(),w()().endOf("year").toDate()],selectedTypes:["inquiry","contract"],apiStateNeedsUpdate:!0,synced:!1,justLoaded:!0,updateTab:!1,bookingList:[],thisYear:w()().year(),thisMonth:w()().format("MMMM"),yearCompleted:0,yearContracts:0}},computed:{filterDateSpan:function(){return w()(this.filterDates[1]).diff(w()(this.filterDates[0]),"weeks")},series:function(){function t(t,e){return new Array(e-t).fill().map((function(e,a){return a+t}))}var e=w.a.weekdaysShort().reverse(),a=[],i=w()({year:2022}).startOf("year");return t(0,i.day()).forEach((function(){})),e.forEach((function(t){a.push({name:t,data:[2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,4,6,8,3,3,1,2,3,1]})})),a},state:function(){},filteredBookingList:function(){var t=[],e=this.filterDates,a=this.selectedTypes;return this.bookingList.forEach((function(i,s){-1!=a.indexOf(i.status)&&w()(e[1]).isSameOrAfter(w.a.unix(i.departureDate))&&w()(e[0]).isSameOrBefore(w.a.unix(i.departureDate))&&t.push(i)})),t},heatmapData:function(){if(0==bookingList.length)return[];console.log(bookingList[150])},filterStats:function(){var t=this.filteredBookingList,e=this.bookingList;if(e.length>0){var a=function(t,e,a){var i=[];return Array(12).fill().map((function(t,e){return e})).forEach((function(s){var n=0;t.forEach((function(t,i){w.a.unix(t.departureDate).year()==e&&w.a.unix(t.departureDate).month()==s&&t.status==a&&(n+=t.value,t.value)})),i.push(n)})),i},i=t.filter((function(t){return"completed"==t.status})),s=t.filter((function(t){return"inquiry"==t.status})),n=t.filter((function(t){return"contract"==t.status})),r=(this.filterDates[1].year,function(){function t(t,e){return new Array(e-t).fill().map((function(e,a){return a+t}))}var i=w.a.unix(e[0].departureDate).year(),s=w.a.unix(e[e.length-1].departureDate).year(),n=[],r=0;return t(i,s+1).forEach((function(t){r+=1,n.push({label:"completed",data:a(e,t,"completed"),backgroundColor:"hsl(141, "+r/(s+1-i)*71+"%, 48%)",stack:t},{label:"contract",data:a(e,t,"contract"),backgroundColor:"hsl(141, "+r/(s+1-i)*71+"%, 48%)",stack:t},{label:"inquiry",data:a(e,t,"inquiry"),backgroundColor:"hsl(48, "+r/(s+1-i)*100+"%, 67%)",stack:t})})),n}),o={chartData:{labels:w.a.monthsShort(),datasets:r()},completed:{number:i.length,totalValue:i.map((function(t){return w()(t.value)})).reduce((function(t,e){return t+e}),0),totalPaid:i.map((function(t){return w()(t.total)})).reduce((function(t,e){return t+e}),0),averageValue:i.length>0?Math.round(i.map((function(t){return w()(t.value)})).reduce((function(t,e){return t+e}),0)/i.length):0},inquiry:{number:s.length,totalPaid:s.map((function(t){return w()(t.total)})).reduce((function(t,e){return t+e}),0),totalValue:s.map((function(t){return w()(t.value)})).reduce((function(t,e){return t+e}),0),averageValue:s.length>0?Math.round(s.map((function(t){return w()(t.value)})).reduce((function(t,e){return t+e}),0)/s.length):0},contract:{number:n.length,totalPaid:n.map((function(t){return w()(t.paid)})).reduce((function(t,e){return t+e}),0),totalValue:n.map((function(t){return w()(t.value)})).reduce((function(t,e){return t+e}),0),averageValue:n.length>0?Math.round(n.map((function(t){return w()(t.value)})).reduce((function(t,e){return t+e}),0)/n.length):0},total:{number:t.length,totalPaid:t.map((function(t){return w()(t.total)})).reduce((function(t,e){return t+e}),0),totalValue:t.map((function(t){return w()(t.value)})).reduce((function(t,e){return t+e}),0),averageValue:t.length>0?Math.round(t.map((function(t){return w()(t.value)})).reduce((function(t,e){return t+e}),0)/t.length):0,tax:t.map((function(t){return w()(t.tax)})).reduce((function(t,e){return t+e}),0),taxNights:t.map((function(t){return w()(t.taxNights)})).reduce((function(t,e){return t+e}),0)}};return o}}},mounted:function(){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getApiBookings("list");case 2:t.setDateFilter("all");case 3:case"end":return e.stop()}}),e)})))()},watch:{state:{handler:function(){this.state!=this.apiState&&(this.apiStateNeedsUpdate=!0),localStorage.setItem("state",JSON.stringify(this.state))},deep:!0}},methods:{setDateFilter:function(t){if("year"==t)this.filterDates=[w()().startOf("year").toDate(),w()().endOf("year").toDate()];else if("previous-year"==t)this.filterDates=[w()().subtract(1,"year").startOf("year").toDate(),w()().subtract(1,"year").endOf("year").toDate()];else if("month"==t)this.filterDates=[w()().startOf("month").toDate(),w()().endOf("month").toDate()];else if("previous-month"==t)this.filterDates=[w()().subtract(1,"year").startOf("month").toDate(),w()().subtract(1,"year").endOf("month").toDate()];else if("all"==t){var e=this.bookingList,a=e.map((function(t){return w.a.unix(t.departureDate)}));this.filterDates=[w.a.min(a).toDate(),w.a.max(a).toDate()]}return null},getYearCompleted:function(t){var e=0,a=w()();return t.forEach((function(t,i){var s=w.a.unix(s);s.year()==a.year()&&"completed"==t.status&&(e+=t.value)})),e},getYearContracts:function(t){var e=0,a=w()();return t.forEach((function(t,i){var s=w.a.unix(s);s.year()==a.year()&&"contract"==t.status&&(e+=t.value)})),e},getStatusColor:function(t){return"inquiry"===t?"is-warning":"contract"===t||"completed"===t?"is-success":"cancelled"===t?"is-dark":"is-light"},humanFormatDateTime:function(t,e){return w.a.unix(t).hour(w.a.unix(e).hour()).minute(w.a.unix(e).minute()).format("ddd D MMM YYYY HH:mm")},humanFormatDate:function(t){return w.a.unix(t).format("ddd D MMM YYYY")},humanFormatTime:function(t){return w.a.unix(t).format("HH:mm")},listEvents:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e,a){var i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={q:a,singleEvents:!0,orderBy:"startTime"},t.next=3,Ot.Events.list(e,i);case 3:return s=t.sent,n=[],s.forEach((function(t){t.calendarId=e,t.description.includes(a)&&n.push(t)})),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));function e(e,a){return t.apply(this,arguments)}return e}(),concatEvents:function(t){var e=[];return t.forEach((function(t){return e=e.concat(t)})),e},getEvent:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e){var a,i,s,n,r,o,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=[],i=0,s=Object.entries(Et.calendarIdList);case 2:if(!(i<s.length)){t.next=12;break}return n=Object(b["a"])(s[i],2),n[0],r=n[1],t.t0=a,t.next=7,this.listEvents(r,e);case 7:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 9:i++,t.next=2;break;case 12:return o=Promise.all(a).then((function(t){return l.concatEvents(a)})),console.log(o),t.abrupt("return",o);case 15:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getApiBookings:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},{},t.next=4,Q()({method:"get",url:"http://localhost:5000/api",headers:a}).then((function(t){return t.data}))["catch"]((function(t){console.log(t)}));case 4:return i=t.sent,"save"===e&&(this.upsertEvent(apiState),this.$router.push("/booking/".concat(apiState.booking.uuid))["catch"]((function(t){}))),"retrieve"===e&&(this.$store.commit("replaceState",apiState),this.updateTab=!0),this.bookingList=i,this.yearCompleted=this.getYearCompleted(i),this.yearContracts=this.getYearContracts(i),t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},Rt=jt,Ft=(a("59bd"),Object(c["a"])(Rt,St,At,!1,null,null,null)),Jt=Ft.exports,qt=a("c0d6"),Vt=a("289d"),Yt=(a("15f5"),a("7051"),a("3003"));s["a"].use(Yt["a"]),s["a"].use(Vt["a"],{defaultIconPack:"fas"}),s["a"].use(i["a"]),s["a"].config.productionTip=!1;var Lt=[{path:"",component:Jt},{path:"/booking",component:Dt},{path:"/booking/:uuid",props:!0,component:Dt}],Ut=new i["a"]({routes:Lt,mode:"history"});new s["a"]({router:Ut,store:qt["a"],render:function(t){return t(d)}}).$mount("#app")},"59bd":function(t,e,a){"use strict";a("6925")},"5f60":function(t,e,a){t.exports=a.p+"img/merle-round-logo.649592f8.png"},6:function(t,e){},6925:function(t,e,a){},7:function(t,e){},8:function(t,e){},"86b4":function(t,e,a){},9:function(t,e){},c4e7:function(t,e,a){"use strict";a("86b4")},e74b:function(t,e,a){"use strict";a("feae")},eea7:function(t){t.exports=JSON.parse('{"type":"service_account","project_id":"stay-manager","private_key_id":"88a20759195d18ceeb5b0c0c40f0c659ebabec9d","private_key":"-----BEGIN PRIVATE KEY-----\\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDK8q6TnSbudg+z\\nLdfG8G6VV/o4T/GDcdvRZY7tlBt6z0YgN1iVuPzeafTkFejYJzKXKd0Ivf1dQ5KY\\nS6TlmphJcwmOUqIIIe1qp1Hx9P41U0Qo96Fbsb/r5jtyLamAbdd6oGoP6x24JhCl\\n55FXNeJAEegVMfUWMj3rD6spANrY9jKzM98YDtndnUmgSKrGNp6TPd/jeSR16nSd\\nNq5gmwnXctLSWRQCUeMJDnzmjSu1KCJemabg0q9yw5wQeKRXm/NELaL5MV3FgLCN\\n/5YJFh8BmOQ5sAt58q20wyMgjPqr1wuddVjR3XRy2emdbdLC6aKdu3jhVWVWjPRu\\n/oYL5z//AgMBAAECggEABfnJoilbldHsHrVhI2wrOflgDVdIsl/XUJA/1bS73LFM\\nlZdnCFhs8IsIcBW3WphITaMoyLLUAU3e6XCDDC+xtoWon4Qyy3ldaWlk+ykp3nk8\\nnIzE7mWvL0uVU1/qicdEfQBvnw4VzxSUbFdMofwvC5B7ahajoWH4MejToMxPXDUt\\nApNX//f589c2J+/qw9Kks6ZErzdlmzsUMLQCGaGGOf5FV7tfG2mGea9mr/YwhPWT\\nJA7Q8250uhUlwaG+7zvdjALIl2oGU4+WGLbVZKFusx3f0do95aRIyjpEUcJgApEB\\nfOcEZ5xxnhKUqQyR5nqjlXq6GXxPGu0vVg2QOk/UwQKBgQD3H9ozJ+ZMN+B3c1gC\\nc9OCKYhQ/gZvi2/qtOj7qpj2HzOE/vIsUA1prOiugIJEqXi5oYnFnN/nbqpHCIZ+\\nFE8fz1Ps/KUvik7TSreZnCyVbPZ8VJdXBmRnWlBZyVXJqVXQPm3RzvYymJM5DXrO\\nL1dsSxlRqUZGrBST4YMMhHuoNwKBgQDSPKfxFuYedoHORU1j0622EpeR9YIjUj5F\\n8AJtz/vhOHJVmHsl3ibPgWxVRJI62XNbVN8AlCesbTjQOkWdEvFgBNb6TNvtDelm\\ngmF7GBan1J13xlk/85uFi9kXV7EoUZaaLhEiER5IHS/2zwJRkiKUASM7gc2LUqW2\\nd5s9DTYyeQKBgHRQG6VEPFLXYeEW+u98kKqM3coxJdpOaMixiY8aRpBhMyB/1oAg\\n1Y9NgN7RQX8LvPSyIWRPZ9tH7QEt9A9Xg75XGQtMBnuPv3YXjr7QEPPrqz/tmKWv\\nLoaurW71IlmeR/ORzqKXpK0/vtt1ir2M7rrbxfj3kUomKDFKTSIRIRqVAoGBAK4X\\nFkaY3LOrFHA3iQ86ESWtHZ/6+em/x9toFMrUKFJmyJ7Cpm9EF0VLeebd4m0i9dhS\\nXlt/U57/zsT3DAA22HPXbiFUleUl2PlOy+P/nXsan864C93eHxGmLX2b2xJ1BU3l\\nCcD5BedXbAlngBcF+OYwTvmO0iMlrB19y6nxj8iZAoGBAPQU9RIJmB1PJ+WclMju\\n9qjUoId9OK9Y6F8KstF3pF5Sf4s9NIlEAbW7dVnildWEnr7+dnfTKWBgIqPaVQgH\\n5WDoU3RYZRObMtkogIcuuCU7ruDfIm5e4yJvKJCVl4dVY6qWnGNeaYTOBtO61emZ\\nApkJqI+qiyxOfQ3eDb3ZBpTG\\n-----END PRIVATE KEY-----\\n","client_email":"stay-manager-calendar@stay-manager.iam.gserviceaccount.com","client_id":"113706036432044224020","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"https://www.googleapis.com/robot/v1/metadata/x509/stay-manager-calendar%40stay-manager.iam.gserviceaccount.com"}')},feae:function(t,e,a){}});
//# sourceMappingURL=index.0535e623.js.map